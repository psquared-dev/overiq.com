<!DOCTYPE html><html lang="en">
<!-- Mirrored from overiq.com/django-1-11/building-djangobin-the-first-steps/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 01 Feb 2025 11:14:03 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset="utf-8"/>
<script>var __ezHttpConsent={setByCat:function(src,tagType,attributes,category,force){var setScript=function(){if(force||window.ezTcfConsent[category]){var scriptElement=document.createElement(tagType);scriptElement.src=src;attributes.forEach(function(attr){for(var key in attr){if(attr.hasOwnProperty(key)){scriptElement.setAttribute(key,attr[key]);}}});var firstScript=document.getElementsByTagName(tagType)[0];firstScript.parentNode.insertBefore(scriptElement,firstScript);}};if(force||(window.ezTcfConsent&&window.ezTcfConsent.loaded)){setScript();}else if(typeof getEzConsentData==="function"){getEzConsentData().then(function(ezTcfConsent){if(ezTcfConsent&&ezTcfConsent.loaded){setScript();}else{console.error("cannot get ez consent data");force=true;setScript();}});}else{force=true;setScript();console.error("getEzConsentData is not a function");}},};</script>
<script>var ezTcfConsent=window.ezTcfConsent?window.ezTcfConsent:{loaded:false,store_info:false,develop_and_improve_services:false,measure_ad_performance:false,measure_content_performance:false,select_basic_ads:false,create_ad_profile:false,select_personalized_ads:false,create_content_profile:false,select_personalized_content:false,understand_audiences:false,use_limited_data_to_select_content:false,};function getEzConsentData(){return new Promise(function(resolve){document.addEventListener("ezConsentEvent",function(event){var ezTcfConsent=event.detail.ezTcfConsent;resolve(ezTcfConsent);});});}</script>
<script>if(typeof _setEzCookies!=='function'){function _setEzCookies(ezConsentData){var cookies=window.ezCookieQueue;for(var i=0;i<cookies.length;i++){var cookie=cookies[i];if(ezConsentData&&ezConsentData.loaded&&ezConsentData[cookie.tcfCategory]){document.cookie=cookie.name+"="+cookie.value;}}}}
window.ezCookieQueue=window.ezCookieQueue||[];if(typeof addEzCookies!=='function'){function addEzCookies(arr){window.ezCookieQueue=[...window.ezCookieQueue,...arr];}}
addEzCookies([]);if(window.ezTcfConsent&&window.ezTcfConsent.loaded){_setEzCookies(window.ezTcfConsent);}else if(typeof getEzConsentData==="function"){getEzConsentData().then(function(ezTcfConsent){if(ezTcfConsent&&ezTcfConsent.loaded){_setEzCookies(window.ezTcfConsent);}else{console.error("cannot get ez consent data");_setEzCookies(window.ezTcfConsent);}});}else{console.error("getEzConsentData is not a function");_setEzCookies(window.ezTcfConsent);}</script>
<script data-ezscrex='false' data-cfasync='false' data-pagespeed-no-defer>var __ez=__ez||{};__ez.stms=Date.now();__ez.evt={};__ez.script={};__ez.ck=__ez.ck||{};__ez.template={};__ez.template.isOrig=true;window.__ezScriptHost="//www.ezojs.com";__ez.queue=__ez.queue||function(){var e=0,i=0,t=[],n=!1,o=[],r=[],s=!0,a=function(e,i,n,o,r,s,a){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:window,d=this;this.name=e,this.funcName=i,this.parameters=null===n?null:w(n)?n:[n],this.isBlock=o,this.blockedBy=r,this.deleteWhenComplete=s,this.isError=!1,this.isComplete=!1,this.isInitialized=!1,this.proceedIfError=a,this.fWindow=l,this.isTimeDelay=!1,this.process=function(){f("... func = "+e),d.isInitialized=!0,d.isComplete=!0,f("... func.apply: "+e);var i=d.funcName.split("."),n=null,o=this.fWindow||window;i.length>3||(n=3===i.length?o[i[0]][i[1]][i[2]]:2===i.length?o[i[0]][i[1]]:o[d.funcName]),null!=n&&n.apply(null,this.parameters),!0===d.deleteWhenComplete&&delete t[e],!0===d.isBlock&&(f("----- F'D: "+d.name),m())}},l=function(e,i,t,n,o,r,s){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:window,l=this;this.name=e,this.path=i,this.async=o,this.defer=r,this.isBlock=t,this.blockedBy=n,this.isInitialized=!1,this.isError=!1,this.isComplete=!1,this.proceedIfError=s,this.fWindow=a,this.isTimeDelay=!1,this.isPath=function(e){return"/"===e[0]&&"/"!==e[1]},this.getSrc=function(e){return void 0!==window.__ezScriptHost&&this.isPath(e)&&"banger.js"!==this.name?window.__ezScriptHost+e:e},this.process=function(){l.isInitialized=!0,f("... file = "+e);var i=this.fWindow?this.fWindow.document:document,t=i.createElement("script");t.src=this.getSrc(this.path),!0===o?t.async=!0:!0===r&&(t.defer=!0),t.onerror=function(){var e={url:window.location.href,name:l.name,path:l.path,user_agent:window.navigator.userAgent};"undefined"!=typeof _ezaq&&(e.pageview_id=_ezaq.page_view_id);var i=encodeURIComponent(JSON.stringify(e)),t=new XMLHttpRequest;t.open("GET/index.html","//g.ezoic.net/ezqlog?d="+i,!0),t.send(),f("----- ERR'D: "+l.name),l.isError=!0,!0===l.isBlock&&m()},t.onreadystatechange=t.onload=function(){var e=t.readyState;f("----- F'D: "+l.name),e&&!/loaded|complete/.test(e)||(l.isComplete=!0,!0===l.isBlock&&m())},i.getElementsByTagName("head")[0].appendChild(t)}},d=function(e,i){this.name=e,this.path="",this.async=!1,this.defer=!1,this.isBlock=!1,this.blockedBy=[],this.isInitialized=!0,this.isError=!1,this.isComplete=i,this.proceedIfError=!1,this.isTimeDelay=!1,this.process=function(){}};function c(e,i,n,s,a,d,c,u,f){var m=new l(e,i,n,s,a,d,c,f);!0===u?o[e]=m:r[e]=m,t[e]=m,h(m)}function h(e){!0!==u(e)&&0!=s&&e.process()}function u(e){if(!0===e.isTimeDelay&&!1===n)return f(e.name+" blocked = TIME DELAY!"),!0;if(w(e.blockedBy))for(var i=0;i<e.blockedBy.length;i++){var o=e.blockedBy[i];if(!1===t.hasOwnProperty(o))return f(e.name+" blocked = "+o),!0;if(!0===e.proceedIfError&&!0===t[o].isError)return!1;if(!1===t[o].isComplete)return f(e.name+" blocked = "+o),!0}return!1}function f(e){var i=window.location.href,t=new RegExp("[?&]ezq=([^&#]*)","i").exec(i);"1"===(t?t[1]:null)&&console.debug(e)}function m(){++e>200||(f("let's go"),p(o),p(r))}function p(e){for(var i in e)if(!1!==e.hasOwnProperty(i)){var t=e[i];!0===t.isComplete||u(t)||!0===t.isInitialized||!0===t.isError?!0===t.isError?f(t.name+": error"):!0===t.isComplete?f(t.name+": complete already"):!0===t.isInitialized&&f(t.name+": initialized already"):t.process()}}function w(e){return"[object Array]"==Object.prototype.toString.call(e)}return window.addEventListener("load",(function(){setTimeout((function(){n=!0,f("TDELAY -----"),m()}),5e3)}),!1),{addFile:c,addFileOnce:function(e,i,n,o,r,s,a,l,d){t[e]||c(e,i,n,o,r,s,a,l,d)},addDelayFile:function(e,i){var n=new l(e,i,!1,[],!1,!1,!0);n.isTimeDelay=!0,f(e+" ...  FILE! TDELAY"),r[e]=n,t[e]=n,h(n)},addFunc:function(e,n,s,l,d,c,u,f,m,p){!0===c&&(e=e+"_"+i++);var w=new a(e,n,s,l,d,u,f,p);!0===m?o[e]=w:r[e]=w,t[e]=w,h(w)},addDelayFunc:function(e,i,n){var o=new a(e,i,n,!1,[],!0,!0);o.isTimeDelay=!0,f(e+" ...  FUNCTION! TDELAY"),r[e]=o,t[e]=o,h(o)},items:t,processAll:m,setallowLoad:function(e){s=e},markLoaded:function(e){if(e&&0!==e.length){if(e in t){var i=t[e];!0===i.isComplete?f(i.name+" "+e+": error loaded duplicate"):(i.isComplete=!0,i.isInitialized=!0)}else t[e]=new d(e,!0);f("markLoaded dummyfile: "+t[e].name)}},logWhatsBlocked:function(){for(var e in t)!1!==t.hasOwnProperty(e)&&u(t[e])}}}();__ez.evt.add=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n()},__ez.evt.remove=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):delete e["on"+t]};__ez.script.add=function(e){var t=document.createElement("script");t.src=e,t.async=!0,t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t)};__ez.dot={};__ez.queue.addFile('../../detroitchicago/boise.js', '../../detroitchicago/boisebb26.js?gcb=195-3&amp;cb=5', true, [], true, false, true, false);__ez.queue.addFile('../../parsonsmaize/abilene.js', '../../parsonsmaize/abilenec0f9.js?gcb=195-3&amp;cb=7f81d60744', true, [], true, false, true, false);__ez.queue.addFile('../../parsonsmaize/mulvane.js', '../../parsonsmaize/mulvane2d63.js?gcb=195-3&amp;cb=e75e48eec0', true, ['/parsonsmaize/abilene.js'], true, false, true, false);__ez.queue.addFile('../../detroitchicago/birmingham.js', '../../detroitchicago/birminghame7ec.js?gcb=195-3&amp;cb=539c47377c', true, ['/parsonsmaize/abilene.js'], true, false, true, false);</script>
<script data-ezscrex="false" type="text/javascript" data-cfasync="false">window._ezaq = Object.assign({"ad_cache_level":1,"adpicker_placement_cnt":0,"ai_placeholder_cache_level":1,"ai_placeholder_placement_cnt":-1,"domain_id":92771,"ezcache_level":1,"ezcache_skip_code":0,"has_bad_image":0,"has_bad_words":0,"is_sitespeed":0,"lt_cache_level":0,"response_size":130431,"response_size_orig":124663,"response_time_orig":882,"template_id":5,"url":"https://overiq.com/django-1-11/building-djangobin-the-first-steps/","word_count":0,"worst_bad_word_level":0}, typeof window._ezaq !== "undefined" ? window._ezaq : {});__ez.queue.markLoaded('ezaqBaseReady');</script>
<script type='text/javascript' data-ezscrex='false' data-cfasync='false'>
window.ezAnalyticsStatic = true;

function analyticsAddScript(script) {
	var ezDynamic = document.createElement('script');
	ezDynamic.type = 'text/javascript';
	ezDynamic.innerHTML = script;
	document.head.appendChild(ezDynamic);
}
function getCookiesWithPrefix() {
    var allCookies = document.cookie.split(';');
    var cookiesWithPrefix = {};

    for (var i = 0; i < allCookies.length; i++) {
        var cookie = allCookies[i].trim();

        for (var j = 0; j < arguments.length; j++) {
            var prefix = arguments[j];
            if (cookie.indexOf(prefix) === 0) {
                var cookieParts = cookie.split('=');
                var cookieName = cookieParts[0];
                var cookieValue = cookieParts.slice(1).join('=');
                cookiesWithPrefix[cookieName] = decodeURIComponent(cookieValue);
                break; // Once matched, no need to check other prefixes
            }
        }
    }

    return cookiesWithPrefix;
}
function productAnalytics() {
	var d = {"pr":[6],"omd5":"69baf971f8a9f84438d20b7563663986"};
	d.u = _ezaq.url;
	d.p = _ezaq.page_view_id;
	d.v = _ezaq.visit_uuid;
	d.ab = _ezaq.ab_test_id;
	d.e = JSON.stringify(_ezaq);
	d.ref = document.referrer;
	d.c = getCookiesWithPrefix('active_template', 'ez', 'lp_');
	if(typeof ez_utmParams !== 'undefined') {
		d.utm = ez_utmParams;
	}

	var dataText = JSON.stringify(d);
	var xhr = new XMLHttpRequest();
	xhr.open('POST/index.html','/ezais/analytics?cb=1', true);
	xhr.onload = function () {
		if (xhr.status!=200) {
            return;
		}

        if(document.readyState !== 'loading') {
            analyticsAddScript(xhr.response);
            return;
        }

        var eventFunc = function() {
            if(document.readyState === 'loading') {
                return;
            }
            document.removeEventListener('readystatechange', eventFunc, false);
            analyticsAddScript(xhr.response);
        };

        document.addEventListener('readystatechange', eventFunc, false);
	};
	xhr.setRequestHeader('Content-Type','text/plain');
	xhr.send(dataText);
}
__ez.queue.addFunc("productAnalytics", "productAnalytics", null, true, ['ezaqBaseReady'], false, false, false, true);
</script><base />
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <title>Building Djangobin - The First Steps - Django 1.11 Tutorial - OverIQ.com</title>

    
    



    <meta name="description" content="In the previous few chapters, we have learned quite a lot about Django. In this chapter, we will take the first steps to build our djangobin applicat…"/>



    <link rel="canonical" href="index.html"/>


<meta property="og:locale" content="en_US"/>
<meta property="og:type" content="article"/>
<meta property="og:title" content="Building Djangobin - The First Steps"/>

    <meta property="og:description" content="In the previous few chapters, we have learned quite a lot about Django. In this chapter, we will take the first steps to build our djangobin applicat…"/>


<meta property="og:url" content="https://overiq.com/django-1-11/building-djangobin-the-first-steps/"/>
<meta property="og:site_name" content="OverIQ.com"/>


<meta property="article:publisher" content="https://www.facebook.com/OverIQ/"/>



<meta name="twitter:card" content="summary_large_image"/>

    <meta name="twitter:description" content="In the previous few chapters, we have learned quite a lot about Django. In this chapter, we will take the first steps to build our djangobin applicat…"/>


<meta name="twitter:title" content="Building Djangobin - The First Steps"/>
<meta name="twitter:site" content="@infoOverIQ"/>

<meta name="twitter:creator" content="@infoOverIQ"/>




    
    
    


    
    
    


    <link rel="alternate" type="application/rss+xml" title="RSS" href="../../feed.xml/index.html"/>
    
    
    <link href="../../../fonts.googleapis.com/cssd2d5.css?family=Open+Sans" rel="stylesheet"/>
    <link rel="stylesheet" href="../../../maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="icon" href="../../static/wiki/favicon.png" sizes="32x32"/>

    <link rel="stylesheet" href="../../static/CACHE/css/output.db46da465a8b.css" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-125424793-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-125424793-1');
    </script>


<script type='text/javascript'>
var ezoTemplate = 'orig_site';
var ezouid = '1';
var ezoFormfactor = '1';
</script><script data-ezscrex="false" type='text/javascript'>
var soc_app_id = '0';
var did = 92771;
var ezdomain = 'overiq.com';
var ezoicSearchable = 1;
</script></head>
<body>

<div class="overiq-header text-center">
    <div class="site-branding">
        <p class="main-title">
            <a href="../../index.html" rel="home">
                OverIQ.com
            </a>
        </p>
    </div>
</div>

<!-- Navigation -->
<nav class="navbar navbar-inverse" role="navigation">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../index.html">Home</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                

                <li>
                    <a href="../../blog/index.html">Blog</a>
                </li>
                <li>
                    <a href="../../contact/index.html">Contact</a>
                </li>
                <li>
                    <a href="../../about/index.html">About</a>
                </li>
            </ul>

            <ul class="nav navbar-nav navbar-right visible-lg visible-md">
                <li>
                    <a href="../../feed.xml/index.html" title="RSS" target="_blank">
                        <i class="fa fa-rss fa-lg" aria-hidden="true"></i>
                    </a>
                </li>
                <li>
                    <a href="https://github.com/overiq/" target="_blank" title="Github">
                        <i class="fa fa-github fa-lg" aria-hidden="true"></i>
                    </a>
                </li>
                <li>
                    <a href="https://www.facebook.com/OverIQ/" target="_blank" title="Facebook">
                        <i class="fa fa-facebook fa-lg" aria-hidden="true"></i>
                    </a>
                </li>
                <li>
                    <a href="https://twitter.com/infoOverIQ" target="_blank" title="Twitter">
                        <i class="fa fa-twitter fa-lg" aria-hidden="true"></i>
                    </a>
                </li>

                

            </ul>

            <form action="https://overiq.com/search/" class="navbar-form navbar-left" role="search">

                <div class="form-group">
                    <input type="text" class="form-control" placeholder="Search" name="query" value=""/>
                </div>

                <button type="submit" class="btn btn-default">Submit</button>
            </form>

        </div>



        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

<div class="container">

    


    <div class="se-pre-con"></div>

    

    <div class="row">

        
        <div class="main">
            <div class="col-lg-8 col-md-8 col-sm-12">
                

    


    
        <ol class="breadcrumb">

    <li><a href="../../index.html">Home</a></li>

    
        
        <li><a href="../index.html">Django 1.11 Tutorial</a></li>
        

        

        
    
        

        

        
            <li class="active">Building Djangobin - The First Steps</li>
        
    

</ol>
    


<h1>Building Djangobin - The First Steps</h1>




    <p><i class="fa fa-calendar" aria-hidden="true"></i>
        Last updated on July 27, 2020
    </p>


<hr/>



<p>In the previous few chapters, we have learned quite a lot about Django. In this chapter, we will take the first steps to build our djangobin application.</p>
<span id="creating-snippets" class="anchor-target"></span><h2 class="heading">Creating Snippets <a class="header-link" href="#creating-snippets">#</a></h2>

<p>Let&#39;s start by building a form which will allow users to submit new snippets.</p>

<p>Open djangobin app&#39;s <code>forms.py</code> file. At this point, it should look like this:</p>

<p><strong>djangobin/django_project/djangobin/forms.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Language</span>


<span class="k">class</span> <span class="nc">LanguageForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Language</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="s1">&#39;__all__&#39;</span>

    <span class="k">def</span> <span class="nf">clean_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;djangobin&#39;</span> <span class="ow">or</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DJANGOBIN&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&#34;name can&#39;t be {}.&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

        <span class="c1"># Always return the data</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">clean_slug</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;slug&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cleaned_data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">LanguageForm</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
        <span class="n">slug</span> <span class="o">=</span> <span class="n">cleaned_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">)</span>
        <span class="n">mime</span> <span class="o">=</span> <span class="n">cleaned_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mime&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">slug</span> <span class="o">==</span> <span class="n">mime</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&#34;Slug and MIME shouldn&#39;t be same.&#34;</span><span class="p">)</span>

        <span class="c1"># Always return the data</span>
        <span class="k">return</span> <span class="n">cleaned_data</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Delete everything and enter the following code:</p>

<p><strong>djangobin/django_project/djangobin/forms.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Snippet</span><span class="p">,</span> <span class="n">Language</span><span class="p">,</span> <span class="n">Author</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">Preference</span><span class="p">,</span> <span class="n">get_current_user</span>


<span class="k">class</span> <span class="nc">SnippetForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Snippet</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;original_code&#39;</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;expiration&#39;</span><span class="p">,</span> <span class="s1">&#39;exposure&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">)</span>
        <span class="n">widgets</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;original_code&#39;</span><span class="p">:</span> <span class="n">forms</span><span class="o">.</span><span class="n">Textarea</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;form-control&#39;</span><span class="p">,</span> <span class="s1">&#39;rows&#39;</span><span class="p">:</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;spellcheck&#39;</span><span class="p">:</span> <span class="s1">&#39;false&#39;</span><span class="p">}),</span>
            <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="n">forms</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;selectpicker foo form-control&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;data-live-search&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;data-size&#39;</span><span class="p">:</span> <span class="s1">&#39;5&#39;</span><span class="p">}),</span>
            <span class="s1">&#39;expiration&#39;</span><span class="p">:</span> <span class="n">forms</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;selectpicker form-control&#39;</span><span class="p">}),</span>
            <span class="s1">&#39;exposure&#39;</span><span class="p">:</span> <span class="n">forms</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;selectpicker form-control&#39;</span><span class="p">}),</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">forms</span><span class="o">.</span><span class="n">TextInput</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;selectpicker form-control&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;placeholder&#39;</span><span class="p">:</span> <span class="s1">&#39;Enter Title (optional)&#39;</span><span class="p">}),</span>            
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="c1"># get the Snippet object, without saving it into the database</span>
        <span class="n">snippet</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SnippetForm</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">commit</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">snippet</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">get_current_user</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="n">snippet</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">snippet</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Here we are defining a <code>SnippetForm</code> class which inherits from <code>forms.ModelForm</code>. The <code>model</code> attribute of the <code>Meta</code> class connects <code>SnippetForm</code> to the <code>Snippet</code> model and <code>fields</code> attribute specifies a list of model fields that you want to show in the form. </p>

<p>In line 12, we are using <code>widgets</code> attribute of the inner <code>Meta</code> class to add bootstrap CSS classes and other attributes to the model fields.</p>

<p>In lines 24-29, we are overriding the <code>save()</code> method of the <code>ModelForm</code> class. The <code>save()</code> method takes <code>request</code> as an argument so that the logged in user can be accessed inside the method. In line 26, we are calling the parent class&#39;s <code>save()</code> method with <code>commit=True</code>. By default, the <code>ModelForm</code>&#39;s <code>save()</code> method creates an instance of the model that the form is connected to, saves it to the database and returns it. If you call <code>save()</code> method with <code>commit=True</code> then it only creates and returns the model instance without saving it to the database. We usually do this when we want to modify the object before saving or set some additional data, which is what we do next.</p>

<p>In line 27, we are calling <code>get_current_user()</code> function with the <code>request</code> argument. The <code>get_current_user()</code> is a utility function defined in djangobin app&#39;s <code>utils.py</code> file as follows:</p>

<p><strong>djangobin/django_project/djangobin/utils.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
</span>

<span class="k">class</span> <span class="nc">Preference</span><span class="p">:</span>
    <span class="c1">#...</span>


<span class="hll"><span class="k">def</span> <span class="nf">get_current_user</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span class="hll">    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">:</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>
</span><span class="hll">    <span class="k">else</span><span class="p">:</span>
</span><span class="hll">       <span class="k">return</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;guest&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>
</td></tr></tbody></table></div>
<p>A <code>Snippet</code> model has a one-to-many relationship with the <code>User</code> model. As a result, a <code>Snippet</code> object must be associated with a <code>User</code> object. If a user is creating snippet after logging in then we want to assign the snippet to that user. Otherwise, we want to assign the snippet to a guest user. This is essentially what <code>get_current_user()</code> function does. If the user is logged in then <code>get_current_user()</code> returns an instance of that user. Otherwise, it returns an instance of a guest user which is just a <code>User</code> object whose <code>username</code> is <code>guest</code>.</p>

<p>Once the user is set, we save the <code>Snippet</code> object and return it.</p>

<p>Start the Django shell and create a new <code>guest</code> user as follows:</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span>
<span class="o">...</span>  <span class="n">username</span><span class="o">=</span><span class="s1">&#39;guest&#39;</span><span class="p">,</span>
<span class="o">...</span>  <span class="n">email</span><span class="o">=</span><span class="s1">&#39;guest@overiq.com&#39;</span><span class="p">,</span>
<span class="o">...</span>  <span class="n">password</span><span class="o">=</span><span class="s1">&#39;password&#39;</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&lt;</span><span class="n">User</span><span class="p">:</span> <span class="n">guest</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Next, open <code>views.py</code> and add modify <code>index()</code> view function at the top of the file as follows:</p>

<p><strong>djangobin/django_project/djangobin/views.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">HttpResponse</span><span class="p">,</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">get_object_or_404</span><span class="p">,</span> <span class="n">reverse</span>
</span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">messages</span>
<span class="hll"><span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="n">SnippetForm</span>
</span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Language</span>


<span class="hll"><span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>        
</span><span class="hll">    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span>  <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
</span><span class="hll">        <span class="n">f</span> <span class="o">=</span> <span class="n">SnippetForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
</span><span class="hll">            <span class="n">snippet</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>            
</span><span class="hll">            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;djangobin:snippet_detail&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">snippet</span><span class="o">.</span><span class="n">slug</span><span class="p">]))</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">else</span><span class="p">:</span>
</span><span class="hll">        <span class="n">f</span> <span class="o">=</span> <span class="n">SnippetForm</span><span class="p">()</span>
</span><span class="hll">    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;djangobin/index.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">f</span><span class="p">})</span>
</span>

<span class="k">def</span> <span class="nf">snippet_detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">snippet_slug</span><span class="p">):</span>
    <span class="c1">#...</span>
</pre></div>
</td></tr></tbody></table></div>
<p>This view function displays the <code>SnippetForm</code> form and saves the submitted snippet to the database.</p>

<p>Before, we move on to the next section remove <code>add_lang</code> and <code>update_lang</code> URL patterns and view functions associated with it.</p>
<span id="a-base-template-for-djangobin" class="anchor-target"></span><h2 class="heading">A Base Template For Djangobin <a class="header-link" href="#a-base-template-for-djangobin">#</a></h2>

<p>Next, let&#39;s set up a base template for djangobin app. Create a template named <code>base.html</code> in <code>templates/</code> directory of the djangobin app with the following code:</p>

<p><strong>djangobin/django_project/djangobin/templates/djangobin/base.html</strong></p>
<div class="codeblock language-jinja"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="x">&lt;!DOCTYPE html&gt;</span>
<span class="x">&lt;html lang=&#34;en&#34;&gt;</span>
<span class="x">&lt;head&gt;</span>

<span class="x">    </span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">static</span> <span class="cp">%}</span><span class="x"></span>

<span class="x">    &lt;meta charset=&#34;utf-8&#34;&gt;</span>
<span class="x">    &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;IE=edge&#34;&gt;</span>
<span class="x">    &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1&#34;&gt;</span>
<span class="x">    &lt;title&gt;</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span><span class="x">Djangobin</span><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x">&lt;/title&gt;</span>

<span class="x">    &lt;!-- Bootstrap --&gt;</span>
<span class="x">    &lt;link rel=&#34;stylesheet&#34; href=&#34;</span><span class="cp">{%</span> <span class="k">static</span> <span class="s1">&#39;djangobin/css/bootstrap.min.css&#39;</span> <span class="cp">%}</span><span class="x">&#34; &gt;</span>

<span class="x">    &lt;!-- Latest compiled and minified CSS --&gt;</span>
<span class="x">    &lt;link rel=&#34;stylesheet&#34; href=&#34;</span><span class="cp">{%</span> <span class="k">static</span> <span class="s1">&#39;djangobin/css/bootstrap-select.min.css&#39;</span> <span class="cp">%}</span><span class="x">&#34; &gt;</span>

<span class="x">    &lt;link href=&#34;https://use.fontawesome.com/releases/v5.0.7/css/all.css&#34; rel=&#34;stylesheet&#34;&gt;</span>

<span class="x">    &lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;</span>
<span class="x">    &lt;!-- WARNING: Respond.js doesn&#39;t work if you view the page via file:// --&gt;</span>
<span class="x">    &lt;!--[if lt IE 9]&gt;</span>
<span class="x">    &lt;script src=&#34;https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js&#34;&gt;&lt;/script&gt;</span>
<span class="x">    &lt;script src=&#34;https://oss.maxcdn.com/respond/1.4.2/respond.min.js&#34;&gt;&lt;/script&gt;</span>
<span class="x">    &lt;![endif]--&gt;</span>

<span class="x">    &lt;link rel=&#34;stylesheet&#34; href=&#34;</span><span class="cp">{%</span> <span class="k">static</span> <span class="s1">&#39;djangobin/css/main.css&#39;</span> <span class="cp">%}</span><span class="x">&#34;&gt;</span>
<span class="x">    &lt;link rel=&#34;stylesheet&#34; href=&#34;</span><span class="cp">{%</span> <span class="k">static</span> <span class="s1">&#39;djangobin/css/default.css&#39;</span> <span class="cp">%}</span><span class="x">&#34;&gt;</span>
<span class="x">&lt;/head&gt;</span>
<span class="x">&lt;body&gt;</span>

<span class="x">&lt;nav class=&#34;navbar navbar-default navbar-inverse navbar-fixed-top&#34;&gt;</span>
<span class="x">    &lt;div class=&#34;container&#34;&gt;</span>
<span class="x">        &lt;!-- Brand and toggle get grouped for better mobile display --&gt;</span>
<span class="x">        &lt;div class=&#34;navbar-header&#34;&gt;</span>
<span class="x">            &lt;button type=&#34;button&#34; class=&#34;navbar-toggle collapsed&#34;</span>
<span class="x">                    data-toggle=&#34;collapse&#34; data-target=&#34;#bs-example-navbar-collapse-1&#34;</span>
<span class="x">                    aria-expanded=&#34;false&#34;&gt;</span>
<span class="x">                &lt;span class=&#34;sr-only&#34;&gt;Toggle navigation&lt;/span&gt;</span>
<span class="x">                &lt;span class=&#34;icon-bar&#34;&gt;&lt;/span&gt;</span>
<span class="x">                &lt;span class=&#34;icon-bar&#34;&gt;&lt;/span&gt;</span>
<span class="x">                &lt;span class=&#34;icon-bar&#34;&gt;&lt;/span&gt;</span>
<span class="x">            &lt;/button&gt;</span>
<span class="x">            &lt;a class=&#34;navbar-brand&#34; href=&#34;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;djangobin:index&#39;</span> <span class="cp">%}</span><span class="x">&#34;&gt;DjangoBin&lt;/a&gt;</span>
<span class="x">        &lt;/div&gt;</span>

<span class="x">        &lt;!-- Collect the nav links, forms, and other content for toggling --&gt;</span>
<span class="x">        &lt;div class=&#34;collapse navbar-collapse&#34; id=&#34;bs-example-navbar-collapse-1&#34;&gt;</span>
<span class="x">            &lt;ul class=&#34;nav navbar-nav&#34;&gt;</span>
<span class="x">                &lt;li </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">request.path</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span> <span class="cp">%}</span><span class="x">class=&#39;active&#39;</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"> &gt;</span>
<span class="x">                    &lt;a href=&#34;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;djangobin:index&#39;</span> <span class="cp">%}</span><span class="x">&#34;&gt;Add new&lt;/a&gt;</span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">                &lt;li </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">request.path</span> <span class="o">==</span> <span class="s1">&#39;/trending/&#39;</span> <span class="cp">%}</span><span class="x">class=&#39;active&#39;</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x">&gt;</span>
<span class="x">                    &lt;a href=&#34;&#34;&gt;Trending&lt;span class=&#34;sr-only&#34;&gt;(current)&lt;/span&gt;&lt;/a&gt;</span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">                &lt;li </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">request.path</span> <span class="o">==</span> <span class="s1">&#39;/about/&#39;</span> <span class="cp">%}</span><span class="x">class=&#39;active&#39;</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x">&gt;</span>
<span class="x">                    &lt;a href=&#34;&#34;&gt;About&lt;/a&gt;</span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">                &lt;li </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">request.path</span> <span class="o">==</span> <span class="s1">&#39;/contact/&#39;</span> <span class="cp">%}</span><span class="x">class=&#39;active&#39;</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x">&gt;</span>
<span class="x">                    &lt;a href=&#34;&#34;&gt;Contact&lt;/a&gt;</span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">            &lt;/ul&gt;</span>

<span class="x">            &lt;form action=&#34;&#34; class=&#34;navbar-form navbar-left&#34; method=&#34;get&#34;&gt;</span>
<span class="x">                &lt;div class=&#34;form-group&#34;&gt;</span>
<span class="x">                    &lt;input type=&#34;text&#34; name=&#34;query&#34; class=&#34;form-control&#34; placeholder=&#34;Search&#34; value=&#34;&#34;&gt;</span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">            &lt;/form&gt;</span>
<span class="x">            &lt;ul class=&#34;nav navbar-nav navbar-right&#34;&gt;</span>
<span class="x">                &lt;li class=&#34;dropdown&#34;&gt;</span>
<span class="x">                    &lt;a href=&#34;#&#34; class=&#34;dropdown-toggle&#34; data-toggle=&#34;dropdown&#34; role=&#34;button&#34;</span>
<span class="x">                       aria-haspopup=&#34;true&#34; aria-expanded=&#34;false&#34;&gt;</span>
<span class="x">                        </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">request.user.is_authenticated</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">                            </span><span class="cp">{{</span> <span class="nv">request.user.username</span><span class="o">|</span><span class="nf">upper</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">                        </span><span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">                            GUEST</span>
<span class="x">                        </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">                        &lt;span class=&#34;caret&#34;&gt;&lt;/span&gt;</span>
<span class="x">                    &lt;/a&gt;</span>
<span class="x">                    </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">request.user.is_authenticated</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">                        &lt;ul class=&#34;dropdown-menu&#34;&gt;</span>
<span class="x">                            &lt;li&gt;&lt;a href=&#34;&#34;&gt;My Pastes&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">                            &lt;li&gt;&lt;a href=&#34;&#34;&gt;Account Details&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">                            &lt;li&gt;&lt;a href=&#34;&#34;&gt;Settings&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">                            &lt;li role=&#34;separator&#34; class=&#34;divider&#34;&gt;&lt;/li&gt;</span>
<span class="x">                            &lt;li&gt;&lt;a href=&#34;&#34;&gt;Logout&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">                        &lt;/ul&gt;</span>
<span class="x">                    </span><span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">                        &lt;ul class=&#34;dropdown-menu&#34;&gt;</span>
<span class="x">                            &lt;li&gt;&lt;a href=&#34;&#34;&gt;Sign Up&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">                            &lt;li&gt;&lt;a href=&#34;&#34;&gt;Login&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">                        &lt;/ul&gt;</span>
<span class="x">                    </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">            &lt;/ul&gt;</span>
<span class="x">        &lt;/div&gt;&lt;!-- /.navbar-collapse --&gt;</span>
<span class="x">    &lt;/div&gt;&lt;!-- /.container-fluid --&gt;</span>
<span class="x">&lt;/nav&gt;</span>


<span class="x">&lt;div class=&#34;container&#34;&gt;</span>

<span class="x">    &lt;div class=&#34;row&#34;&gt;</span>

<span class="x">        &lt;div class=&#34;col-lg-9 col-md-9&#34;&gt;</span>

<span class="x">            </span><span class="cp">{%</span> <span class="k">if</span> <span class="k">not</span> <span class="nv">request.user.is_authenticated</span> <span class="k">and</span> <span class="k">not</span> <span class="nv">request.path</span> <span class="o">==</span> <span class="s1">&#39;/login/&#39;</span>  <span class="cp">%}</span><span class="x"></span>
<span class="x">                &lt;p class=&#34;alert alert-info&#34;&gt;</span>
<span class="x">                    &lt;a href=&#34;&#34; class=&#34;alert-link&#34;&gt;Login&lt;/a&gt; to access other cool features.</span>
<span class="x">                &lt;/p&gt;</span>
<span class="x">            </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>


<span class="x">            </span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">main</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">                </span><span class="c">{#  override this block in the child template  #}</span><span class="x"></span>
<span class="x">            </span><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"></span>

<span class="x">        &lt;/div&gt;</span>

<span class="x">        &lt;div class=&#34;col-lg-3 col-md-3 text-center hidden-sm hidden-xs&#34;&gt;</span>
<span class="x">            &lt;p&gt;Recent Snippets&lt;/p&gt;</span>

<span class="x">            &lt;div class=&#34;list-group&#34;&gt;</span>
<span class="x">                &lt;a href=&#34;#&#34; class=&#34;list-group-item&#34;&gt;</span>
<span class="x">                    &lt;h5 class=&#34;list-group-item-heading&#34;&gt;&lt;span class=&#34;fas fa-globe&#34;</span>
<span class="x">                        &#34;&gt;&lt;/span&gt; Untitled (css)&lt;/h5&gt;</span>
<span class="x">                    &lt;p class=&#34;list-group-item-text&#34;&gt;21 sec ago.&lt;/p&gt;</span>
<span class="x">                &lt;/a&gt;</span>

<span class="x">                &lt;a href=&#34;#&#34; class=&#34;list-group-item&#34;&gt;</span>
<span class="x">                    &lt;h5 class=&#34;list-group-item-heading&#34;&gt;&lt;span class=&#34;fas fa-globe&#34;</span>
<span class="x">                        &#34;&gt;&lt;/span&gt; Untitled (c++)&lt;/h5&gt;</span>
<span class="x">                    &lt;p class=&#34;list-group-item-text&#34;&gt;21 sec ago.&lt;/p&gt;</span>
<span class="x">                &lt;/a&gt;</span>
<span class="x">                &lt;a href=&#34;#&#34; class=&#34;list-group-item&#34;&gt;</span>
<span class="x">                    &lt;h5 class=&#34;list-group-item-heading&#34;&gt;&lt;span class=&#34;fas fa-globe&#34;</span>
<span class="x">                        &#34;&gt;&lt;/span&gt; Login View in Django&lt;/h5&gt;</span>
<span class="x">                    &lt;p class=&#34;list-group-item-text&#34;&gt;21 sec ago.&lt;/p&gt;</span>
<span class="x">                &lt;/a&gt;</span>
<span class="x">                &lt;a href=&#34;#&#34; class=&#34;list-group-item&#34;&gt;</span>
<span class="x">                    &lt;h5 class=&#34;list-group-item-heading&#34;&gt;&lt;span class=&#34;fas fa-globe&#34;</span>
<span class="x">                        &#34;&gt;&lt;/span&gt; CBVs In Django...&lt;/h5&gt;</span>
<span class="x">                    &lt;p class=&#34;list-group-item-text&#34;&gt;21 sec ago.&lt;/p&gt;</span>
<span class="x">                &lt;/a&gt;</span>
<span class="x">                &lt;a href=&#34;#&#34; class=&#34;list-group-item&#34;&gt;</span>
<span class="x">                    &lt;h5 class=&#34;list-group-item-heading&#34;&gt;&lt;span class=&#34;fas fa-globe&#34;</span>
<span class="x">                        &#34;&gt;&lt;/span&gt; Untitled&lt;/h5&gt;</span>
<span class="x">                    &lt;p class=&#34;list-group-item-text&#34;&gt;21 sec ago.&lt;/p&gt;</span>
<span class="x">                &lt;/a&gt;</span>
<span class="x">                &lt;a href=&#34;#&#34; class=&#34;list-group-item&#34;&gt;</span>
<span class="x">                    &lt;h5 class=&#34;list-group-item-heading&#34;&gt;&lt;span class=&#34;fas fa-globe&#34;</span>
<span class="x">                        &#34;&gt;&lt;/span&gt; Untitled&lt;/h5&gt;</span>
<span class="x">                    &lt;p class=&#34;list-group-item-text&#34;&gt;21 sec ago.&lt;/p&gt;</span>
<span class="x">                &lt;/a&gt;</span>
<span class="x">                &lt;a href=&#34;#&#34; class=&#34;list-group-item&#34;&gt;</span>
<span class="x">                    &lt;h5 class=&#34;list-group-item-heading&#34;&gt;&lt;span class=&#34;fas fa-globe&#34;</span>
<span class="x">                        &#34;&gt;&lt;/span&gt; Untitled&lt;/h5&gt;</span>
<span class="x">                    &lt;p class=&#34;list-group-item-text&#34;&gt;21 sec ago.&lt;/p&gt;</span>
<span class="x">                &lt;/a&gt;</span>
<span class="x">                &lt;a href=&#34;#&#34; class=&#34;list-group-item&#34;&gt;</span>
<span class="x">                    &lt;h5 class=&#34;list-group-item-heading&#34;&gt;&lt;span class=&#34;fas fa-globe&#34;</span>
<span class="x">                        &#34;&gt;&lt;/span&gt; Untitled&lt;/h5&gt;</span>
<span class="x">                    &lt;p class=&#34;list-group-item-text&#34;&gt;21 sec ago.&lt;/p&gt;</span>
<span class="x">                &lt;/a&gt;</span>
<span class="x">            &lt;/div&gt;</span>

<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>

<span class="x">&lt;hr&gt;</span>

<span class="x">&lt;footer&gt;</span>
<span class="x">    &lt;div class=&#34;social-icons&#34;&gt;</span>
<span class="x">        &lt;div class=&#34;container text-center&#34;&gt;</span>
<span class="x">            &lt;ul class=&#34;list-inline&#34;&gt;</span>
<span class="x">                &lt;li class=&#34;list-inline-item social-github&#34;&gt;</span>
<span class="x">                    &lt;a href=&#34;https://github.com/&#34;&gt;</span>
<span class="x">                        &lt;i class=&#34;fab fa-github&#34;&gt;&lt;/i&gt;</span>
<span class="x">                    &lt;/a&gt;</span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">                &lt;li class=&#34;list-inline-item social-twitter&#34;&gt;</span>
<span class="x">                    &lt;a href=&#34;https://twitter.com/&#34;&gt;</span>
<span class="x">                        &lt;i class=&#34;fab fa-twitter-square&#34;&gt;&lt;/i&gt;</span>
<span class="x">                    &lt;/a&gt;</span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">                &lt;li class=&#34;list-inline-item social-facebook&#34;&gt;</span>
<span class="x">                    &lt;a href=&#34;https://www.facebook.com/&#34;&gt;</span>
<span class="x">                        &lt;i class=&#34;fab fa-facebook-square&#34;&gt;&lt;/i&gt;</span>
<span class="x">                    &lt;/a&gt;</span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">                &lt;li class=&#34;list-inline-item social-google-plus&#34;&gt;</span>
<span class="x">                    &lt;a href=&#34;https://plus.google.com/&#34;&gt;</span>
<span class="x">                        &lt;i class=&#34;fab fa-google-plus-g&#34;&gt;&lt;/i&gt;</span>
<span class="x">                    &lt;/a&gt;</span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">            &lt;/ul&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>

<span class="x">    &lt;div class=&#34;main-footer&#34;&gt;</span>
<span class="x">        &lt;div class=&#34;container text-center&#34;&gt;</span>
<span class="x">            &lt;ul&gt;</span>
<span class="x">                &lt;li&gt;&lt;a href=&#34;#&#34;&gt;Source Code&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">                &lt;li&gt;&lt;a href=&#34;#&#34;&gt;OverIQ&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">                &lt;li&gt;&lt;a href=&#34;#&#34;&gt;Contact&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">                &lt;li&gt;&lt;a href=&#34;#&#34;&gt;Other Tutorials&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">            &lt;/ul&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">&lt;/footer&gt;</span>

<span class="x">&lt;!-- jQuery (necessary for Bootstrap&#39;s JavaScript plugins) --&gt;</span>
<span class="x">&lt;script src=</span><span class="cp">{%</span> <span class="k">static</span> <span class="s2">&#34;djangobin/js/jquery.js&#34;</span> <span class="cp">%}</span><span class="x">&gt;&lt;/script&gt;</span>

<span class="x">&lt;!-- Include all compiled plugins (below), or include individual files as needed --&gt;</span>
<span class="x">&lt;!-- Latest compiled and minified JavaScript --&gt;</span>
<span class="x">&lt;script src=</span><span class="cp">{%</span> <span class="k">static</span> <span class="s2">&#34;djangobin/js/bootstrap.min.js&#34;</span> <span class="cp">%}</span><span class="x">&gt;&lt;/script&gt;</span>

<span class="x">&lt;!-- Latest compiled and minified JavaScript --&gt;</span>
<span class="x">&lt;script src=</span><span class="cp">{%</span> <span class="k">static</span> <span class="s2">&#34;djangobin/js/bootstrap-select.min.js&#34;</span> <span class="cp">%}</span><span class="x">&gt;&lt;/script&gt;</span>

<span class="x">&lt;script&gt;</span>
<span class="x">    $(function () {</span>
<span class="x">        $(&#39;[data-toggle=&#34;tooltip&#34;]&#39;).tooltip()</span>
<span class="x">    })</span>

<span class="x">&lt;/script&gt;</span>

<span class="x">&lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Most of the code should be straightforward. But we will still go through it just to make sure you understand everything.</p>

<p>Recall that inside the template you always have access to the <code>request</code> variable. We use this variable to access the details of the current web request and the logged in user.</p>

<p>In line 5, we load <code>{% static %}</code> tag using the <code>{% load %}</code> tag.</p>

<p>In line 10, we define a block named <code>title</code>. The templates which inherit from this template can fill the block with content.</p>

<p>In lines 27-28, we use <code>{% static %}</code> tag to build URLs for the CSS files.</p>

<p>In lines 50-61, we use several <code>{% if %}</code> tags to add a class of <code>active</code> to the corresponding <code>&lt;li&gt;</code> element to highlight the current option in the menu.</p>

<p>In lines 73-77, we test whether the user is logged in. If so, we display logged in username after applying the <code>upper</code> filter. If the user is not logged in, we display <code>GUEST</code>.</p>

<p>In lines 80-93, we again test whether the user logged in. If so, we display some profile related links like My Pastes, Settings, Logout and so on. Otherwise, we display links to Login and Sign Up page.</p>

<p>In lines 107-111, we display a link to the login page, only if the user is not logged and <code>request.path</code> is not equal to <code>/login/</code>.</p>

<p>In line 114, we define a block named <code>main</code>. The content for this block will be provided by the child template.</p>

<p>In lines 214-221, we again use <code>{% static %}</code> tag to build links to the JavaScript files.</p>

<p>As you might have noticed, the <code>href</code> attribute of the most <code>&lt;a&gt;</code> element is empty. We will update them as we move along.</p>

<p>Now, we create a child template named <code>index.html</code> in the <code>templates</code> directory <br/>
with the following code:</p>

<p><strong>djangobin/django_project/djangobin/templates/djangobin/index.html</strong></p>
<div class="codeblock language-jinja"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;djangobin/base.html&#39;</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">load</span> <span class="nv">static</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">main</span> <span class="cp">%}</span><span class="x"></span>

<span class="x">    &lt;form action=&#34;&#34; class=&#34;form-horizontal&#34; method=&#34;post&#34;&gt;</span>

<span class="x">        </span><span class="cp">{%</span> <span class="k">csrf_token</span> <span class="cp">%}</span><span class="x"></span>

<span class="x">        </span><span class="cp">{{</span> <span class="nv">form.original_code.errors</span> <span class="cp">}}</span><span class="x"></span>

<span class="x">        </span><span class="cp">{{</span> <span class="nv">form.original_code</span> <span class="cp">}}</span><span class="x"></span>

<span class="x">        &lt;hr&gt;</span>

<span class="x">        &lt;div class=&#34;form-group&#34;&gt;</span>
<span class="x">            &lt;label for=&#34;</span><span class="cp">{{</span> <span class="nv">form.language.id_for_label</span> <span class="cp">}}</span><span class="x">&#34; class=&#34;col-sm-2 control-label&#34;&gt;Language&lt;/label&gt;</span>
<span class="x">            &lt;div class=&#34;col-lg-10 col-md-10 col-sm-10&#34;&gt;</span>
<span class="x">                </span><span class="cp">{{</span> <span class="nv">form.language</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>

<span class="x">        </span><span class="cp">{{</span> <span class="nv">form.expiration.errors</span> <span class="cp">}}</span><span class="x"></span>

<span class="x">        &lt;div class=&#34;form-group&#34;&gt;</span>
<span class="x">            &lt;label for=&#34;</span><span class="cp">{{</span> <span class="nv">form.expiration.id_for_label</span> <span class="cp">}}</span><span class="x">&#34; class=&#34;col-sm-2  control-label&#34;&gt;Expiration&lt;/label&gt;</span>
<span class="x">            &lt;div class=&#34;col-lg-10 col-md-10 col-sm-10&#34;&gt;</span>
<span class="x">                </span><span class="cp">{{</span> <span class="nv">form.expiration</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>

<span class="x">        </span><span class="cp">{{</span> <span class="nv">form.exposure.errors</span> <span class="cp">}}</span><span class="x"></span>

<span class="x">        &lt;div class=&#34;form-group&#34;&gt;</span>
<span class="x">            &lt;label for=&#34;</span><span class="cp">{{</span> <span class="nv">form.exposure.id_for_label</span> <span class="cp">}}</span><span class="x">&#34; class=&#34;col-sm-2  control-label&#34;&gt;Exposure&lt;/label&gt;</span>
<span class="x">            &lt;div class=&#34;col-lg-10 col-md-10 col-sm-10&#34;&gt;</span>
<span class="x">                </span><span class="cp">{{</span> <span class="nv">form.exposure</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>

<span class="x">        &lt;div class=&#34;form-group&#34;&gt;</span>
<span class="x">            &lt;label for=&#34;</span><span class="cp">{{</span> <span class="nv">form.title.id_for_label</span> <span class="cp">}}</span><span class="x">&#34; class=&#34;col-sm-2  control-label&#34;&gt;Title&lt;/label&gt;</span>
<span class="x">            &lt;div class=&#34;col-lg-10 col-md-10 col-sm-10&#34;&gt;</span>
<span class="x">                </span><span class="cp">{{</span> <span class="nv">form.title</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>

<span class="x">        &lt;div class=&#34;form-group&#34;&gt;</span>
<span class="x">            &lt;label for=&#34;</span><span class="cp">{{</span> <span class="nv">form.tags.id_for_label</span> <span class="cp">}}</span><span class="x">&#34; class=&#34;col-sm-2  control-label&#34;&gt;Tags&lt;/label&gt;</span>
<span class="x">            &lt;div class=&#34;col-lg-10 col-md-10 col-sm-10&#34;&gt;</span>
<span class="x">                </span><span class="cp">{{</span> <span class="nv">form.tags</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>

<span class="x">        &lt;div class=&#34;form-group&#34;&gt;</span>
<span class="x">            &lt;label for=&#34;inputEmail3&#34; class=&#34;col-sm-2 control-label&#34;&gt;&lt;/label&gt;</span>
<span class="x">            &lt;div class=&#34;col-lg-10 col-md-10 col-sm-10&#34;&gt;</span>
<span class="x">                &lt;button type=&#34;submit&#34; class=&#34;btn btn-primary&#34;&gt;Create&lt;/button&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>

<span class="x">    &lt;/form&gt;</span>

<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</td></tr></tbody></table></div>
<p>There is nothing new in this template that deserves an explanation. We are merely using things we have learned up until now. In case you need a refresher check out <a href="../basics-of-django-templates/index.html">Basics of Django templates</a> chapter.</p>

<p>If you now visit <code>http://localhost:8000/</code>. You will see a page like this:</p>

<p><img src="../../media/uploads/2018/5/28/Selection_165-c8edacad-0fa4-4347-9a7e-d4d6521183b9.png" loading="lazy" alt=""/></p>

<p>The page appears to be rendering correctly but there is one problem. </p>

<p>Take a closer look at how <code>Tags</code> field is rendered:</p>

<p><img src="../../media/uploads/2018/5/28/Selection_166-11e58125-2ed4-4f16-81d7-3fa7c692b955.png" loading="lazy" alt=""/></p>

<p>Since <code>Snippet</code> model has a many-to-many relationship with <code>Tag</code> model, the tags are displayed using multiple selection <code>&lt;select&gt;</code> box. This means that you can only select tags which already exists in the database.</p>

<p>It is impossible to anticipate all the tags that users will be using to create snippets. As a result, a better approach would be to let users specify a comma-separated list of tags while creating a snippet. To do that we have to define a new form field in the <code>SnippetForm</code> class.</p>

<p>In the <code>forms.py</code>, define <code>snippet_tag</code> field above the <code>Meta</code> class as follows:</p>

<p><strong>djangobin/django_project/djangobin/forms.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#...</span>
<span class="k">class</span> <span class="nc">SnippetForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>

<span class="hll">    <span class="n">snippet_tags</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
</span><span class="hll">                           <span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">TextInput</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span>
</span><span class="hll">                               <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;selectpicker form-control&#39;</span><span class="p">,</span>
</span><span class="hll">                               <span class="s1">&#39;placeholder&#39;</span><span class="p">:</span> <span class="s1">&#39;Enter tags (optional)&#39;</span>
</span><span class="hll">                            <span class="p">}))</span>
</span><span class="hll">
</span>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Snippet</span>
<span class="c1">#...</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Also, remove the <code>tags</code> field from the <code>fields</code> attribute of the <code>Meta</code> class.</p>

<p><strong>djangobin/django_project/djangobin/forms.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#...</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Snippet</span>
<span class="hll">        <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;original_code&#39;</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;expiration&#39;</span><span class="p">,</span> <span class="s1">&#39;exposure&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,)</span>
</span>        <span class="n">widgets</span> <span class="o">=</span> <span class="p">{</span>
<span class="c1">#...</span>
</pre></div>
</td></tr></tbody></table></div>
<p>To incorporate the changes we now have to update the <code>save()</code> method of the <code>SnippetForm</code> class.</p>

<p><strong>djangobin/django_project/djangobin/forms.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span>
<span class="hll"><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Snippet</span><span class="p">,</span> <span class="n">Language</span><span class="p">,</span> <span class="n">Author</span><span class="p">,</span> <span class="n">Tag</span>
</span><span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">Preference</span><span class="p">,</span> <span class="n">get_current_user</span>


<span class="k">class</span> <span class="nc">SnippetForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
    <span class="c1">#...</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">snippet</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SnippetForm</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">commit</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">snippet</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">get_current_user</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="n">snippet</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="hll">        <span class="n">tag_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">tag</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> 
</span><span class="hll">                   <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;snippet_tags&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">tag</span> <span class="p">]</span>
</span><span class="hll">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tag_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span class="hll">            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tag_list</span><span class="p">:</span>
</span><span class="hll">                <span class="n">t</span> <span class="o">=</span> <span class="n">Tag</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
</span><span class="hll">                <span class="n">snippet</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span>        <span class="k">return</span> <span class="n">snippet</span>
</pre></div>
</td></tr></tbody></table></div>
<p>In line 14, we are using list comprehension along with <code>cleaned_data</code> attribute of the form object to create a list of submitted tags.</p>

<p>If <code>tag_list</code> is not empty, we loop over it using a for loop. Inside the for loop, we create <code>Tag</code> object (only if it doesn&#39;t already exist) and associate it with the <code>Snippet</code> object.</p>

<p>It is important to note that <code>snippet_tags</code> field of <code>SnippetForm</code> is a completely new field and it is not related to <code>tags</code> field of the <code>Snippet</code> model in any way.</p>

<p>At last, update <code>index.html</code> to use <code>snippets_tags</code> field as follows:</p>

<p><strong>djangobin/django_project/djangobin/templates/djangobin/index.html</strong></p>
<div class="codeblock language-jinja"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">{# ... #}</span><span class="x"></span>
<span class="x">        &lt;div class=&#34;form-group&#34;&gt;</span>
<span class="x">            &lt;label for=&#34;</span><span class="cp">{{</span> <span class="nv">form.title.id_for_label</span> <span class="cp">}}</span><span class="x">&#34; class=&#34;col-sm-2  control-label&#34;&gt;Title&lt;/label&gt;</span>
<span class="x">            &lt;div class=&#34;col-lg-10 col-md-10 col-sm-10&#34;&gt;</span>
<span class="x">                </span><span class="cp">{{</span> <span class="nv">form.title</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>

<span class="hll"><span class="x">        &lt;div class=&#34;form-group&#34;&gt;</span>
</span><span class="hll"><span class="x">            &lt;label for=&#34;</span><span class="cp">{{</span> <span class="nv">form.snippet_tags.id_for_label</span> <span class="cp">}}</span><span class="x">&#34; class=&#34;col-sm-2  control-label&#34;&gt;Tags&lt;/label&gt;</span>
</span><span class="hll"><span class="x">            &lt;div class=&#34;col-lg-10 col-md-10 col-sm-10&#34;&gt;</span>
</span><span class="hll"><span class="x">                </span><span class="cp">{{</span> <span class="nv">form.snippet_tags</span> <span class="cp">}}</span><span class="x"></span>
</span><span class="hll"><span class="x">            &lt;/div&gt;</span>
</span><span class="hll"><span class="x">        &lt;/div&gt;</span>
</span>
<span class="x">        &lt;div class=&#34;form-group&#34;&gt;</span>
<span class="x">            &lt;label for=&#34;inputEmail3&#34; class=&#34;col-sm-2 control-label&#34;&gt;&lt;/label&gt;</span>
<span class="x">            &lt;div class=&#34;col-lg-10 col-md-10 col-sm-10&#34;&gt;</span>
<span class="x">                &lt;button type=&#34;submit&#34; class=&#34;btn btn-primary&#34;&gt;Create&lt;/button&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="c">{# ... #}</span><span class="x"></span>
</pre></div>
</td></tr></tbody></table></div>
<p>We can now specify comma separated list of tags while creating snippets.<br/>
In the next section, we will create the page to display the highlighted snippet.</p>
<span id="displaying-snippets" class="anchor-target"></span><h2 class="heading">Displaying Snippets <a class="header-link" href="#displaying-snippets">#</a></h2>

<p>In the <code>views.py</code> file, modify <code>snippet_detail()</code> view , just below the <code>index()</code> view function as follows:</p>

<p><strong>djangobin/django_project/djangobin/views.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#...</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Language</span><span class="p">,</span> <span class="n">Snippet</span>

<span class="c1">#...</span>

<span class="k">def</span> <span class="nf">snippet_detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">snippet_slug</span><span class="p">):</span>
    <span class="n">snippet</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Snippet</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="n">snippet_slug</span><span class="p">)</span>
    <span class="n">snippet</span><span class="o">.</span><span class="n">hits</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">snippet</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;djangobin/snippet_detail.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;snippet&#39;</span><span class="p">:</span> <span class="n">snippet</span><span class="p">})</span>
</pre></div>
</td></tr></tbody></table></div>
<p>This view function displays the highlighted snippet and also increments the hits count by 1.</p>

<p>Create a new template named <code>snippet_detail.html</code> in the <code>templates</code> directory with the following code:</p>

<p><strong>djangobin/django_project/djangobin/templates/djangobin/snippet_detail.html</strong></p>
<div class="codeblock language-jinja"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;djangobin/base.html&#39;</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">load</span> <span class="nv">static</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">main</span> <span class="cp">%}</span><span class="x"></span>

<span class="x">    &lt;div class=&#34;media post-meta&#34;&gt;</span>
<span class="x">        &lt;div class=&#34;media-left&#34;&gt;</span>
<span class="x">            &lt;a href=&#34;#&#34;&gt;</span>
<span class="x">                &lt;img alt=&#34;64x64&#34; class=&#34;media-object&#34; data-src=&#34;holder.js/64x64&#34; src=&#34;data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+PCEtLQpTb3VyY2UgVVJMOiBob2xkZXIuanMvNjR4NjQKQ3JlYXRlZCB3aXRoIEhvbGRlci5qcyAyLjYuMC4KTGVhcm4gbW9yZSBhdCBodHRwOi8vaG9sZGVyanMuY29tCihjKSAyMDEyLTIwMTUgSXZhbiBNYWxvcGluc2t5IC0gaHR0cDovL2ltc2t5LmNvCi0tPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PCFbQ0RBVEFbI2hvbGRlcl8xNjFkYzE3YWQ0ZiB0ZXh0IHsgZmlsbDojQUFBQUFBO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1mYW1pbHk6QXJpYWwsIEhlbHZldGljYSwgT3BlbiBTYW5zLCBzYW5zLXNlcmlmLCBtb25vc3BhY2U7Zm9udC1zaXplOjEwcHQgfSBdXT48L3N0eWxlPjwvZGVmcz48ZyBpZD0iaG9sZGVyXzE2MWRjMTdhZDRmIj48cmVjdCB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIGZpbGw9IiNFRUVFRUUiLz48Zz48dGV4dCB4PSIxMi4xNzk2ODc1IiB5PSIzNi41Ij42NHg2NDwvdGV4dD48L2c+PC9nPjwvc3ZnPg==&#34; data-holder-rendered=&#34;true&#34; style=&#34;width: 64px; height: 64px;&#34;&gt;</span>
<span class="x">            &lt;/a&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&#34;media-body&#34;&gt;</span>
<span class="x">            &lt;h4 class=&#34;media-heading&#34;&gt;</span><span class="cp">{{</span> <span class="nv">snippet.title</span><span class="o">|</span><span class="nf">default</span><span class="s2">:&#34;Untitled&#34;</span> <span class="cp">}}</span><span class="x">&lt;/h4&gt;</span>
<span class="x">            &lt;p&gt;</span>
<span class="x">                &lt;i class=&#34;fas fa-user&#34; data-toggle=&#34;tooltip&#34; title=&#34;&#34; data-original-title=&#34;Paste creator&#34;&gt;&lt;/i&gt; by</span>
<span class="x">                </span><span class="cp">{{</span> <span class="nv">snippet.user.username</span><span class="o">|</span><span class="nf">capfirst</span> <span class="cp">}}</span><span class="x"> &amp;nbsp;</span>
<span class="x">                &lt;i class=&#34;fas fa-calendar-alt&#34; data-toggle=&#34;tooltip&#34; title=&#34;&#34; data-original-title=&#34;Creation Date&#34; &gt;&lt;/i&gt;</span>
<span class="x">                &lt;time title=&#34;</span><span class="cp">{{</span> <span class="nv">snippet.created_on</span> <span class="cp">}}</span><span class="x">&#34;&gt;</span><span class="cp">{{</span> <span class="nv">snippet.created_on</span><span class="o">|</span><span class="nf">date</span><span class="s2">:&#34;M jS,  Y&#34;</span> <span class="cp">}}</span><span class="x">&lt;/time&gt; &amp;nbsp;&lt;/span&gt;</span>
<span class="x">                &lt;i class=&#34;fas fa-eye&#34;  data-toggle=&#34;tooltip&#34; title=&#34;&#34; data-original-title=&#34;Visits to this paste&#34; &gt;&lt;/i&gt;</span>
<span class="x">                </span><span class="cp">{{</span> <span class="nv">snippet.hits</span> <span class="cp">}}</span><span class="x"> &amp;nbsp;&amp;nbsp;</span>
<span class="x">                &lt;i class=&#34;fas fa-stopwatch&#34; data-toggle=&#34;tooltip&#34; title=&#34;&#34; data-original-title=&#34;Expiration time&#34;&gt;&lt;/i&gt;</span>
<span class="x">                </span><span class="cp">{{</span> <span class="nv">snippet.expiration</span> <span class="cp">}}</span><span class="x">  &amp;nbsp;</span>
<span class="x">                </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">snippet.tags.all</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">                    &lt;i class=&#34;fas fa-tags&#34; data-toggle=&#34;tooltip&#34; title=&#34;&#34; data-original-title=&#34;Tags&#34;&gt;&lt;/i&gt;</span>
<span class="x">                    </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">tag</span> <span class="k">in</span> <span class="nv">snippet.tags.all</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">                        &lt;a href=&#34;&#34;&gt;</span><span class="cp">{{</span> <span class="nv">tag</span> <span class="cp">}}</span><span class="x">&lt;/a&gt;</span><span class="cp">{%</span> <span class="k">if</span> <span class="k">not</span> <span class="nb">forloop</span><span class="nv">.last</span> <span class="cp">%}</span><span class="x">,</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">                    </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">                </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">            &lt;/p&gt;</span>
<span class="x">        &lt;/div&gt;</span>

<span class="x">    &lt;/div&gt;</span>

<span class="x">    &lt;div class=&#34;codeblock&#34;&gt;</span>
<span class="x">        &lt;div class=&#34;toolbar clearfix&#34;&gt;</span>
<span class="x">            &lt;span class=&#34;at-left&#34;&gt;&lt;a href=&#34;&#34;&gt;</span><span class="cp">{{</span> <span class="nv">snippet.language</span> <span class="cp">}}</span><span class="x">&lt;/a&gt;&lt;/span&gt;</span>
<span class="x">            &lt;span class=&#34;at-right&#34;&gt;</span>
<span class="x">                &lt;a onclick=&#34;return confirm(&#39;Sure you want to delete this paste? &#39;)&#34; href=&#34;&#34;&gt;delete&lt;/a&gt;</span>
<span class="x">                &lt;a href=&#34;&#34;&gt;raw&lt;/a&gt;</span>
<span class="x">                &lt;a href=&#34;&#34;&gt;download&lt;/a&gt;</span>
<span class="x">            &lt;/span&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&#34;code-wrapper&#34;&gt;</span><span class="cp">{{</span> <span class="nv">snippet.highlighted_code</span><span class="o">|</span><span class="nf">safe</span> <span class="cp">}}</span><span class="x">&lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>

<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</td></tr></tbody></table></div>
<p>In lines 13-31, we display metadata of the snippet and in line 44, we display the highlighted code.</p>

<p>Now visit <code>http://localhost:8000/</code> and try creating a snippet. You will get the snippet detail page like this:</p>

<p><img src="../../media/uploads/2018/5/28/Selection_167-52e9c69c-2150-4733-a1bc-d923babc7de4.png" loading="lazy" alt=""/></p>
<span id="downloading-snippets" class="anchor-target"></span><h2 class="heading">Downloading Snippets <a class="header-link" href="#downloading-snippets">#</a></h2>

<p>Just below <code>snippet_detail()</code> view, define <code>download_snippet()</code> view function as follows:</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#...</span>

<span class="k">def</span> <span class="nf">download_snippet</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">snippet_slug</span><span class="p">):</span>
    <span class="n">snippet</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Snippet</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="n">snippet_slug</span><span class="p">)</span>
    <span class="n">file_extension</span> <span class="o">=</span> <span class="n">snippet</span><span class="o">.</span><span class="n">language</span><span class="o">.</span><span class="n">file_extension</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">snippet</span><span class="o">.</span><span class="n">slug</span> <span class="o">+</span> <span class="n">file_extension</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">snippet</span><span class="o">.</span><span class="n">original_code</span><span class="p">)</span>
    <span class="n">res</span><span class="p">[</span><span class="s1">&#39;content-disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=&#39;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&#34;;&#34;</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>
</td></tr></tbody></table></div>
<p>This view function retrieves the snippet from the database, sends it to the client.</p>

<p>Note that we are setting an additional header named <code>Content-Disposition</code> just after the creation of <code>HttpResponse</code> instance. The <code>Content-Disposition</code> header tells the browser to save the response as an attachment instead of displaying it.</p>

<p>Next, open djangobin app&#39;s <code>urls.py</code> and add a new URL pattern named <code>download_snippet</code> as follows:</p>

<p><strong>djangobin/django_project/djangobin/urls.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#...</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1">#...</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">&#39;^trending/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">trending_snippets</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;trending_snippets&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">&#39;^trending/(?P&lt;language_slug&gt;[\w]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">trending_snippets</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;trending_snippets&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">&#39;^(?P&lt;snippet_slug&gt;[\d]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">snippet_detail</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;snippet_detail&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">&#39;^tag/(?P&lt;tag&gt;[\w-]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">tag_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;tag_list&#39;</span><span class="p">),</span>
<span class="hll">    <span class="n">url</span><span class="p">(</span><span class="s1">&#39;^download/(?P&lt;snippet_slug&gt;[\d]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">download_snippet</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;download_snippet&#39;</span><span class="p">),</span>
</span><span class="p">]</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Now, to let users download code, we have to add a link in the snippet details page. Open <code>snippet_detail.html</code> and modify the <code>&lt;div&gt;</code> tag with <code>class=&#34;codeblock&#34;</code> as follows:</p>

<p><strong>djangobin/django_project/djangobin/templates/djangobin/snippet_detail.html</strong></p>
<div class="codeblock language-jinja"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">{#  ...  #}</span><span class="x"></span>
<span class="x">    &lt;div class=&#34;codeblock&#34;&gt;</span>
<span class="x">        &lt;div class=&#34;toolbar clearfix&#34;&gt;</span>
<span class="x">            &lt;span class=&#34;at-left&#34;&gt;&lt;a href=&#34;&#34;&gt;</span><span class="cp">{{</span> <span class="nv">snippet.language</span> <span class="cp">}}</span><span class="x">&lt;/a&gt;&lt;/span&gt;</span>
<span class="x">            &lt;span class=&#34;at-right&#34;&gt;</span>
<span class="x">                &lt;a onclick=&#34;return confirm(&#39;Sure you want to delete this paste? &#39;)&#34; href=&#34;&#34;&gt;delete&lt;/a&gt;</span>
<span class="x">                &lt;a href=&#34;&#34;&gt;raw&lt;/a&gt;</span>
<span class="hll"><span class="x">                &lt;a href=&#34;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;djangobin:download_snippet&#39;</span> <span class="nv">snippet.slug</span> <span class="cp">%}</span><span class="x">&#34;&gt;download&lt;/a&gt;</span>
</span><span class="x">            &lt;/span&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&#34;code-wrapper&#34;&gt;</span><span class="cp">{{</span> <span class="nv">snippet.highlighted_code</span><span class="o">|</span><span class="nf">safe</span> <span class="cp">}}</span><span class="x">&lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="c">{#  ...  #}</span><span class="x"></span>
</pre></div>
</td></tr></tbody></table></div>
<p>Visit <code>http://localhost:8000/</code> and create a new snippet. In the snippet detail page click the &#34;download&#34; link to download the snippet.</p>

<p><img src="../../media/uploads/2018/5/28/Selection_168-8900dc7f-8080-49e4-8a54-3693823085c3.png" loading="lazy" alt=""/></p>
<span id="displaying-raw-snippets" class="anchor-target"></span><h2 class="heading">Displaying Raw Snippets <a class="header-link" href="#displaying-raw-snippets">#</a></h2>

<p>In the <code>views.py</code>, add <code>raw_snippet()</code> view function below the <code>download_snippet()</code> view as follows:</p>

<p><strong>djangobin/django_project/djangobin/views.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#...</span>
<span class="k">def</span> <span class="nf">raw_snippet</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">snippet_slug</span><span class="p">):</span>
    <span class="n">snippet</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Snippet</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="n">snippet_slug</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">snippet</span><span class="o">.</span><span class="n">original_code</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">snippet</span><span class="o">.</span><span class="n">language</span><span class="o">.</span><span class="n">mime</span><span class="p">)</span>
</pre></div>
</td></tr></tbody></table></div>
<p>This view will display the snippet in raw format.</p>

<p>Add a new URL pattern named <code>raw_snippet</code> to <code>urls.py</code> as follows:</p>

<p><strong>djangobin/django_project/djangobin/utils.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#...</span>
<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1">#...</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">&#39;^(?P&lt;snippet_slug&gt;[\d]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">snippet_detail</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;snippet_detail&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">&#39;^tag/(?P&lt;tag&gt;[\w-]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">tag_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;tag_list&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">&#39;^download/(?P&lt;snippet_slug&gt;[\d]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">download_snippet</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;download_snippet&#39;</span><span class="p">),</span>
<span class="hll">    <span class="n">url</span><span class="p">(</span><span class="s1">&#39;^raw/(?P&lt;snippet_slug&gt;[\d]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">raw_snippet</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;raw_snippet&#39;</span><span class="p">),</span> 
</span><span class="p">]</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Finally, add a link to raw snippet in <code>snippet_detail.html</code> template as follows:</p>
<div class="codeblock language-jinja"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">{# ... #}</span><span class="x"></span>
<span class="x">&lt;div class=&#34;codeblock&#34;&gt;</span>
<span class="x">    &lt;div class=&#34;toolbar clearfix&#34;&gt;</span>
<span class="x">            &lt;span class=&#34;at-left&#34;&gt;&lt;a href=&#34;&#34;&gt;</span><span class="cp">{{</span> <span class="nv">snippet.language</span> <span class="cp">}}</span><span class="x">&lt;/a&gt;&lt;/span&gt;</span>
<span class="x">            &lt;span class=&#34;at-right&#34;&gt;</span>
<span class="x">                &lt;a onclick=&#34;return confirm(&#39;Sure you want to delete this paste? &#39;)&#34; href=&#34;&#34;&gt;delete&lt;/a&gt;</span>
<span class="hll"><span class="x">                &lt;a href=&#34;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;djangobin:raw_snippet&#39;</span> <span class="nv">snippet.slug</span> <span class="cp">%}</span><span class="x">&#34;&gt;raw&lt;/a&gt;</span>
</span><span class="x">                &lt;a href=&#34;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;djangobin:download_snippet&#39;</span> <span class="nv">snippet.slug</span> <span class="cp">%}</span><span class="x">&#34;&gt;download&lt;/a&gt;</span>
<span class="x">            &lt;/span&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;div class=&#34;code-wrapper&#34;&gt;</span><span class="cp">{{</span> <span class="nv">snippet.highlighted_code</span><span class="o">|</span><span class="nf">safe</span> <span class="cp">}}</span><span class="x">&lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="c">{# ... #}</span><span class="x"></span>
</pre></div>
</td></tr></tbody></table></div>
<p>You can now view the raw snippet by clicking the &#34;raw&#34; link in the Snippet detail page.</p>

<p><img src="../../media/uploads/2018/5/28/Selection_169-5c04cc42-932e-45f5-aed8-9724b3854fd3.png" loading="lazy" alt=""/></p>
<span id="displaying-recent-snippets-using-context-processor" class="anchor-target"></span><h2 class="heading">Displaying Recent Snippets using Context Processor <a class="header-link" href="#displaying-recent-snippets-using-context-processor">#</a></h2>

<p>We want to display recent public snippets on every page of our Djangobin application. Currently, recent Snippet list is just a series of hardcoded <code>&lt;a&gt;</code> tags.</p>

<p><img src="../../media/uploads/2018/5/28/Selection_170-c4a0c6e5-ba7b-4d4f-88ec-faaddee5c2fc.png" loading="lazy" alt=""/></p>

<p>At first, you might think that we can easily display recent snippets by doing something like this:</p>

<p><strong>djangobin/django_project/djangobin/views.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">snippet_detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">snippet_slug</span><span class="p">):</span>
    <span class="n">recent_snippet</span> <span class="o">=</span> <span class="n">Snippet</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">exposure</span><span class="o">=</span><span class="s1">&#39;public&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&#34;-created_on&#34;</span><span class="p">)[:</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">snippet</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Snippet</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="n">snippet_slug</span><span class="p">)</span>
    <span class="n">snippet</span><span class="o">.</span><span class="n">hits</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">snippet</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;djangobin/snippet_detail.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;snippet&#39;</span><span class="p">:</span> <span class="n">snippet</span><span class="p">,</span> 
                                                             <span class="s1">&#39;recent_snippet&#39;</span><span class="p">:</span> <span class="n">recent_snippet</span><span class="p">})</span>
</pre></div>
</td></tr></tbody></table></div>
<p>There is nothing wrong with this approach, the only problem is that if we choose to go by this route then we would have to repeatedly fetch recent snippet list and pass it to the respective template inside every view function - Context Processor to the rescue.</p>

<p>In lesson <a href="../loading-templates-in-django/index.html">Loading Templates</a>, we have learned that <code>render()</code> function automatically makes certain variables available inside all the templates. Two such variables are <code>request</code> and <code>message</code>. The <code>request</code> variable which contains data about the current request and <code>messages</code> variable contains the flash messages. The <code>render()</code> function does this using something called <code>RequestContext</code>.</p>

<p>The <code>RequestContext</code> is just a special subclass of <code>Context</code>. The <code>RequestContext</code> differs from <code>Context</code> in the following ways:</p>

<ol>
<li>It accepts <code>request</code> as its first argument.</li>
<li>It automatically populates the template context, based on the <code>context_processors</code> option.</li>
</ol>

<p>The <code>context_processors</code> is just list of callables, called context processor. Each context processor is a function which accepts a <code>HttpRequest</code> object and returns a dictionary of items to be merged into the template context. By default <code>context_processors</code> list looks like this:</p>

<p><strong>djangobin/django_project/django_project/settings.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#...</span>
<span class="n">TEMPLATES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s1">&#39;BACKEND&#39;</span><span class="p">:</span> <span class="s1">&#39;django.template.backends.django.DjangoTemplates&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DIRS&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;templates&#39;</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="s1">&#39;APP_DIRS&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;context_processors&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s1">&#39;django.template.context_processors.debug&#39;</span><span class="p">,</span>
                <span class="s1">&#39;django.template.context_processors.request&#39;</span><span class="p">,</span>
                <span class="s1">&#39;django.contrib.auth.context_processors.auth&#39;</span><span class="p">,</span>
                <span class="s1">&#39;django.contrib.messages.context_processors.messages&#39;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
<span class="p">]</span>
<span class="c1">#...</span>
</pre></div>
</td></tr></tbody></table></div>
<p>The source of <code>request</code> and <code>message</code> callables looks like this:</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">request</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;request&#39;</span><span class="p">:</span> <span class="n">request</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">messages</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&#34;&#34;&#34;</span>
<span class="sd">    Returns a lazy &#39;messages&#39; context variable.</span>
<span class="sd">    &#34;&#34;&#34;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;messages&#39;</span><span class="p">:</span> <span class="n">get_messages</span><span class="p">(</span><span class="n">request</span><span class="p">),</span>
        <span class="s1">&#39;DEFAULT_MESSAGE_LEVELS&#39;</span><span class="p">:</span> <span class="n">DEFAULT_LEVELS</span><span class="p">,</span>
    <span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Now you know from where the <code>request</code> and <code>messages</code> variables come from.</p>

<p>To make a variable globally accessible to all your templates, you&#39;ll have to define a custom context processor.</p>

<p>Create a new file named <code>context_processors.py</code> inside the <code>djangobin</code> app directory and add the following code to it:</p>

<p><strong>djangobin/django_project/djangobin/context_processors.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Snippet</span>


<span class="k">def</span> <span class="nf">recent_snippets</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">recent_snippets</span><span class="o">=</span><span class="n">Snippet</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">exposure</span><span class="o">=</span><span class="s1">&#39;public&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&#34;-id&#34;</span><span class="p">)[:</span><span class="mi">8</span><span class="p">])</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Add this context processor to <code>context_processors</code> option in <code>settings.py</code> file as follows:</p>

<p><strong>djangobin/django_project/django_project/settings.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#...</span>
<span class="n">TEMPLATES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s1">&#39;BACKEND&#39;</span><span class="p">:</span> <span class="s1">&#39;django.template.backends.django.DjangoTemplates&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DIRS&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;templates&#39;</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="s1">&#39;APP_DIRS&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;context_processors&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s1">&#39;django.template.context_processors.debug&#39;</span><span class="p">,</span>
                <span class="s1">&#39;django.template.context_processors.request&#39;</span><span class="p">,</span>
                <span class="s1">&#39;django.contrib.auth.context_processors.auth&#39;</span><span class="p">,</span>
                <span class="s1">&#39;django.contrib.messages.context_processors.messages&#39;</span><span class="p">,</span>
<span class="hll">                <span class="s1">&#39;djangobin.context_processors.recent_snippets&#39;</span><span class="p">,</span>
</span>            <span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
<span class="p">]</span>
<span class="c1">#...</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Now, all of our templates have access to <code>recent_snippets</code> variable.</p>

<p>To display recent snippets we have to make some changes in djangobin application&#39;s <code>base.html</code> file. Open <code>base.html</code> and modify it as follows:</p>

<p><strong>djangobin/django_project/djangobin/templates/djangobin/base.html</strong></p>
<div class="codeblock language-jinja"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">{# ... #}</span><span class="x"></span>
<span class="x">&lt;div class=&#34;col-lg-3 col-md-3 text-center hidden-sm hidden-xs&#34;&gt;</span>
<span class="x">            &lt;p&gt;Recent Snippets&lt;/p&gt;</span>
<span class="x">            &lt;div class=&#34;list-group&#34;&gt;</span>

<span class="hll"><span class="x">                </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">recent_snippet</span> <span class="k">in</span> <span class="nv">recent_snippets</span> <span class="cp">%}</span><span class="x"></span>
</span><span class="hll"><span class="x">                    &lt;a href=&#34;</span><span class="cp">{{</span> <span class="nv">recent_snippet.get_absolute_url</span> <span class="cp">}}</span><span class="x">&#34; class=&#34;list-group-item&#34;&gt;</span>
</span><span class="hll"><span class="x">                        &lt;h5 class=&#34;list-group-item-heading&#34;&gt;&lt;span class=&#34;fa fa-globe</span>
</span><span class="hll"><span class="x">&#34;&gt;&lt;/span&gt; </span><span class="cp">{{</span> <span class="nv">recent_snippet.title</span> <span class="cp">}}</span><span class="x">&lt;/h5&gt;</span>
</span><span class="hll"><span class="x">                        &lt;p class=&#34;list-group-item-text&#34;&gt;</span><span class="cp">{{</span> <span class="nv">recent_snippet.created_on</span> <span class="cp">}}</span><span class="x">&lt;/p&gt;</span>
</span><span class="hll"><span class="x">                    &lt;/a&gt;</span>
</span><span class="hll"><span class="x">                </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
</span>
<span class="x">            &lt;/div&gt;        </span>

<span class="x">        &lt;/div&gt;</span>
<span class="c">{# ... #}</span><span class="x"></span>
</pre></div>
</td></tr></tbody></table></div>
<p>Visit home or snippets detail page and you will see recent snippets list like this:</p>

<p><img src="../../media/uploads/2018/5/28/Selection_171-e4229d9e-cbc6-4742-aee8-ca29d31a3bf5.png" loading="lazy" alt=""/></p>
<span id="humanizing-time" class="anchor-target"></span><h3 class="heading">Humanizing Time <a class="header-link" href="#humanizing-time">#</a></h3>

<p>Currently, recent snippet list displays date and time in the following format:</p>
<div class="codeblock language-text"><div class="highlight"><pre><span></span>&#34;April 12, 2018, 7:09 a.m&#34;
</pre></div>
</div>
<p>A more user-friendly way to would be to display date and time like this:</p>

<ul>
<li>2 weeks ago</li>
<li>23 hours ago</li>
<li>10 seconds ago
and so on.</li>
</ul>

<p>Django comes with a built-in app called humanize which provides template filters to format numbers, date and time. </p>

<p>The humanize app is not installed by default. To install it add<br/><br/>
<code>django.contrib.humanize</code> to the <code>INSTALLED_APPS</code> list in <code>settings.py</code> file as follows:</p>

<p><strong>djangobin/django_project/django_project/settings.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#...</span>
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
<span class="hll">    <span class="s1">&#39;django.contrib.humanize&#39;</span><span class="p">,</span>
</span>    <span class="s1">&#39;djangobin&#39;</span><span class="p">,</span>
<span class="p">]</span>
<span class="c1">#...</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Now open <code>base.html</code> template and add <code>{% load humanize %}</code> just below the line where you are loading the static template tag:</p>

<p><strong>djangobin/django_project/djangobin/templates/djangobin/base.html</strong></p>
<div class="codeblock language-jinja"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="x">&lt;!DOCTYPE html&gt;</span>
<span class="x">&lt;html lang=&#34;en&#34;&gt;</span>
<span class="x">&lt;head&gt;</span>

<span class="x">    </span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">static</span> <span class="cp">%}</span><span class="x"></span>
<span class="hll"><span class="x">    </span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">humanize</span> <span class="cp">%}</span><span class="x"></span>
</span>
<span class="x">    &lt;meta charset=&#34;utf-8&#34;&gt;</span>
<span class="x">    &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;IE=edge&#34;&gt;</span>
<span class="c">{# ... #}</span><span class="x"></span>
</pre></div>
</td></tr></tbody></table></div>
<p>At last, add <code>naturaltime</code> filter to <code>base.html</code> as follows:</p>

<p><strong>djangobin/django_project/djangobin/templates/djangobin/base.html</strong></p>
<div class="codeblock language-jinja"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">{# ... #}</span><span class="x"></span>
<span class="x">&lt;div class=&#34;col-lg-3 col-md-3 text-center hidden-sm hidden-xs&#34;&gt;</span>
<span class="x">            &lt;p&gt;Recent Snippets&lt;/p&gt;</span>

<span class="x">            &lt;div class=&#34;list-group&#34;&gt;</span>

<span class="x">                </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">recent_snippet</span> <span class="k">in</span> <span class="nv">recent_snippets</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">                    &lt;a href=&#34;</span><span class="cp">{{</span> <span class="nv">recent_snippet.get_absolute_url</span> <span class="cp">}}</span><span class="x">&#34; class=&#34;list-group-item&#34;&gt;</span>
<span class="x">                        &lt;h5 class=&#34;list-group-item-heading&#34;&gt;&lt;span class=&#34;fa fa-globe</span>
<span class="x">&#34;&gt;&lt;/span&gt; </span><span class="cp">{{</span> <span class="nv">recent_snippet.title</span> <span class="cp">}}</span><span class="x">&lt;/h5&gt;</span>
<span class="hll"><span class="x">                        &lt;p class=&#34;list-group-item-text&#34;&gt;</span><span class="cp">{{</span> <span class="nv">recent_snippet.created_on</span><span class="o">|</span><span class="nf">naturaltime</span> <span class="cp">}}</span><span class="x">&lt;/p&gt;</span>
</span><span class="x">                    &lt;/a&gt;</span>
<span class="x">                </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>

<span class="x">            &lt;/div&gt;</span>

<span class="x">        &lt;/div&gt;</span>
<span class="c">{# ... #}</span><span class="x"></span>
</pre></div>
</td></tr></tbody></table></div>
<p>Visit home or snippet detail page and you will see the updated date and time format as follows:</p>

<p><img src="../../media/uploads/2018/5/28/Selection_172-99b28bca-395d-4e59-a25e-0aaf0976c77a.png" loading="lazy" alt=""/></p>



    



        <nav aria-label="pagination">
            <ul class="pager">
                
                    <li class="previous">
                        <a href="../handling-media-files-in-django/index.html" title="Handling Media Files in Django">
                            <span class="fa fa-arrow-left" aria-hidden="true"></span>
                            Handling Media Files in Django
                        </a>
                    </li>
                

                
                    <li class="next">
                        <a href="../creating-trending-snippet-page/index.html" title="Creating Trending Snippet Page">
                            Creating Trending Snippet Page
                            <span class="fa fa-arrow-right" aria-hidden="true"></span>
                        </a>
                    </li>
                
            </ul>
        </nav>







    <hr/>
    <div id="disqus_thread">
    <p style="margin-bottom: 10px" class="text-center">
        <a href="#" class=" btn btn-primary comments-holder" onclick="loadDisqus();return false;">
            <i class="fa fa-comments" aria-hidden="true"></i> Load Comments
        </a>
    </p>
    </div>
    <hr/>
    <script>
        var is_disqus_loaded = false;
        function loadDisqus() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = '../../../overiqcom.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        };
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>







            </div>
        </div>


        <div class="sidebar">
        
            <div class="col-lg-4 col-md-4 col-sm-12">
                

    
        
    <div class="well">
        <h4>Django 1.11 Tutorial</h4>
        <ul>
            
                <li><a href="../intro-to-django/index.html">Intro to Django</a></li>
            
                <li><a href="../installing-django/index.html">Installing Django</a></li>
            
                <li><a href="../creating-django-project/index.html">Creating Django Project</a></li>
            
                <li><a href="../mvc-pattern-and-django/index.html">MVC Pattern and Django</a></li>
            
                <li><a href="../views-and-urlconfs-in-django/index.html">Views and URLconfs in Django</a></li>
            
                <li><a href="../creating-urls-and-custom-response/index.html">Creating URLs and Custom Response</a></li>
            
                <li><a href="../basics-of-django-templates/index.html">Basics of Django Templates</a></li>
            
                <li><a href="../template-tags-in-django/index.html">Template tags in Django</a></li>
            
                <li><a href="../template-filters-in-django/index.html">Template filters in Django</a></li>
            
                <li><a href="../loading-templates-in-django/index.html">Loading Templates in Django</a></li>
            
                <li><a href="../template-inheritance-in-django/index.html">Template Inheritance in Django</a></li>
            
                <li><a href="../basics-of-models-in-django/index.html">Basics of Models in Django</a></li>
            
                <li><a href="../migrations-in-django/index.html">Migrations in Django</a></li>
            
                <li><a href="../django-orm-basics-part-1/index.html">Django ORM Basics Part 1</a></li>
            
                <li><a href="../django-orm-basics-part-2/index.html">Django ORM Basics Part 2</a></li>
            
                <li><a href="../django-admin-app/index.html">Django Admin App</a></li>
            
                <li><a href="../django-authentication-framework-basics/index.html">Django Authentication Framework Basics</a></li>
            
                <li><a href="../data-migrations-in-django/index.html">Data migrations in Django</a></li>
            
                <li><a href="../django-form-basics/index.html">Django Form Basics</a></li>
            
                <li><a href="../displaying-forms-in-django/index.html">Displaying Forms in Django</a></li>
            
                <li><a href="../django-rendering-form-fields-manually/index.html">Django Rendering Form Fields Manually</a></li>
            
                <li><a href="../handling-static-content-in-django/index.html">Handling Static Content in Django</a></li>
            
                <li><a href="../handling-media-files-in-django/index.html">Handling Media Files in Django</a></li>
            
                <li><a href="index.html">Building Djangobin - The First Steps</a></li>
            
                <li><a href="../creating-trending-snippet-page/index.html">Creating Trending Snippet Page</a></li>
            
                <li><a href="../building-contact-us-form/index.html">Building Contact Us Form</a></li>
            
                <li><a href="../django-logging-users-in-and-out/index.html">Django Logging Users In and Out</a></li>
            
                <li><a href="../user-registration-in-django/index.html">User Registration in Django</a></li>
            
                <li><a href="../building-profile-pages-for-djangobin/index.html">Building profile pages for Djangobin</a></li>
            
                <li><a href="../searching-snippets/index.html">Searching Snippets</a></li>
            
                <li><a href="../asynchronous-tasks-with-celery/index.html">Asynchronous Tasks with Celery</a></li>
            
                <li><a href="../flatpages-in-django/index.html">Flatpages in Django</a></li>
            
                <li><a href="../creating-sitemaps-in-django/index.html">Creating Sitemaps in Django</a></li>
            
                <li><a href="../settings-for-multiple-environments-in-django/index.html">Settings for Multiple Environments in Django</a></li>
            
                <li><a href="../deploying-django-project-to-digitalocean/index.html">Deploying Django Project to DigitalOcean</a></li>
            
        </ul>
    </div>

    

    
        

<div class="well">
    <h4>Recent Posts</h4>
    <ul>
        
            <li><a href="../../machine-learning-experts-you-should-be-following-online/index.html">Machine Learning Experts You Should Be Following Online</a></li>
        
            <li><a href="../../4-ways-to-prepare-for-the-ap-computer-science-a-exam/index.html">4 Ways to Prepare for the AP Computer Science A Exam</a></li>
        
            <li><a href="../../finance-assignment-online-help-for-the-busy-and-tired-students-get-help-from-experts/index.html">Finance Assignment Online Help for the Busy and Tired Students: Get Help from Experts</a></li>
        
            <li><a href="../../top-9-machine-learning-algorithms-for-data-scientists/index.html">Top 9 Machine Learning Algorithms for Data Scientists</a></li>
        
            <li><a href="../../data-science-learning-path-or-steps-to-become-a-data-scientist-final/index.html">Data Science Learning Path or Steps to become a data scientist Final</a></li>
        
            <li><a href="../../enable-edit-button-in-shutter-in-linux-mint-19-and-ubuntu-18-04/index.html">Enable Edit Button in Shutter In Linux Mint 19 and Ubuntu 18.04</a></li>
        
            <li><a href="../../python-3-time-module/index.html">Python 3 time module</a></li>
        
            <li><a href="../../pygments-tutorial/index.html">Pygments Tutorial</a></li>
        
            <li><a href="../../how-to-use-virtualenv/index.html">How to use Virtualenv?</a></li>
        
            <li><a href="../../installing-mysql-windows-linux-and-mac/index.html">Installing MySQL (Windows, Linux and Mac)</a></li>
        
            <li><a href="../../what-is-if-__name__-__main__-in-python/index.html">What is if __name__ == &#39;__main__&#39;  in Python ?</a></li>
        
            <li><a href="../../installing-goaccess-a-real-time-web-log-analyzer/index.html">Installing GoAccess (A Real-time web log analyzer)</a></li>
        
            <li><a href="../../installing-isso/index.html">Installing Isso</a></li>
        
    </ul>
</div>

<!-- Blog Search Well -->





















    



            </div>
        </div>
    </div>



    

</div>

<!-- Footer -->
<footer class="overiq-footer">
    <div class="container">
        <div class="row">

            <div class="col-lg-3 col-md-3 col-sm-6 overiq-footer-links">
                <ul>
                    <li><a href="../../index.html">Home</a></li>
                    <li><a href="../../terms-of-use/index.html">Terms</a></li>
                    <li><a href="../../privacy-policy/index.html">Privacy Policy</a></li>
                    <li><a href="../../sitemap.xml/index.html">Sitemap</a></li>
                </ul>

            </div>

            <div class="col-lg-3 col-md-3 col-sm-6 overiq-footer-links">
                <ul>
                    <li><a href="../../contact/index.html">Contact</a></li>
                    <li><a href="../../blog/index.html">Blog</a></li>
                </ul>

            </div>

            <div class="col-lg-3 col-md-3 col-sm-6 overiq-footer-links">
                <ul>
                    <li><a href="https://www.facebook.com/OverIQ/">Facebook</a></li>
                    <li><a href="https://twitter.com/infoOverIQ">Twitter</a></li>
                    <li><a href="https://github.com/overiq">Github</a></li>
                </ul>
            </div>

            <div class="col-lg-3 col-md-3 col-sm-6 overiq-footer-links">
                <ul>
                    <li><a href="../../c-programming-101/index.html">C Tutorial</a></li>
                    <li><a href="../../python-101/index.html">Python Tutorial</a></li>
                    <li><a href="../index.html">Django Tutorial</a></li>
                    <li><a href="../../flask-101/index.html">Flask Tutorial</a></li>
                    <li><a href="../../mysql-connector-python-101/index.html">MySQL Connector/Python Tutorial</a></li>
                    <li><a href="../../sqlalchemy-101/index.html">SQLAlchemy Tutorial</a></li>
                    <li><a href="../../c-examples/index.html">C Programming Examples</a></li>
                </ul>
            </div>
            <!-- /.col-lg-12 -->
        </div>
        <div class="row text-center">
            <p>© 2025 OverIQ.com</p>
            <small><a href="#">Back to top</a></small>
        </div>

        <!-- /.row -->
    </div>
</footer>



<script type="text/javascript" src="../../static/CACHE/js/output.2e0ff002c1a4.js"></script>




<script async="" src="../../../cdn.jsdelivr.net/npm/cookieconsent%403/build/cookieconsent.min.js" data-cfasync="false"></script>

<script>

    
    window.addEventListener('load', function () {
        window.cookieconsent.initialise({
            "palette": {
                "popup": {
                    "background": "#5ca9e0",
                    "text": "#ffffff"
                },
                "button": {
                    "background": "#fff",
                    "text": "#237afc"
                }
            },
            "theme": "classic",
            "position": "top",
            "static": true,
            "content": {
                "href": "https://overiq.com/privacy-policy/"
            }
        });
    });


</script>

<script src="../../../polyfill.io/v3/polyfill.min1162.js?features=es6"></script>
<script id="MathJax-script" defer="" src="../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml.js"></script>

<script async="" type="text/javascript" src="../../../cdn.carbonads.com/carbonfbdb.js?serve=CE7DC53E&amp;placement=overiqcom" id="_carbonads_js"></script>





<script data-cfasync="false">function _emitEzConsentEvent(){var customEvent=new CustomEvent("ezConsentEvent",{detail:{ezTcfConsent:window.ezTcfConsent},bubbles:true,cancelable:true,});document.dispatchEvent(customEvent);}
(function(window,document){function _setAllEzConsentTrue(){window.ezTcfConsent.loaded=true;window.ezTcfConsent.store_info=true;window.ezTcfConsent.develop_and_improve_services=true;window.ezTcfConsent.measure_ad_performance=true;window.ezTcfConsent.measure_content_performance=true;window.ezTcfConsent.select_basic_ads=true;window.ezTcfConsent.create_ad_profile=true;window.ezTcfConsent.select_personalized_ads=true;window.ezTcfConsent.create_content_profile=true;window.ezTcfConsent.select_personalized_content=true;window.ezTcfConsent.understand_audiences=true;window.ezTcfConsent.use_limited_data_to_select_content=true;window.ezTcfConsent.select_personalized_content=true;}
function _clearEzConsentCookie(){document.cookie="ezCMPCookieConsent=tcf2;Domain=.overiq.com;Path=/;expires=Thu, 01 Jan 1970 00:00:00 GMT";}
_clearEzConsentCookie();if(typeof window.__tcfapi!=="undefined"){window.ezgconsent=false;var amazonHasRun=false;function _ezAllowed(tcdata,purpose){return(tcdata.purpose.consents[purpose]||tcdata.purpose.legitimateInterests[purpose]);}
function _handleConsentDecision(tcdata){window.ezTcfConsent.loaded=true;if(!tcdata.vendor.consents["347"]&&!tcdata.vendor.legitimateInterests["347"]){window._emitEzConsentEvent();return;}
window.ezTcfConsent.store_info=_ezAllowed(tcdata,"1");window.ezTcfConsent.develop_and_improve_services=_ezAllowed(tcdata,"10");window.ezTcfConsent.measure_content_performance=_ezAllowed(tcdata,"8");window.ezTcfConsent.select_basic_ads=_ezAllowed(tcdata,"2");window.ezTcfConsent.create_ad_profile=_ezAllowed(tcdata,"3");window.ezTcfConsent.select_personalized_ads=_ezAllowed(tcdata,"4");window.ezTcfConsent.create_content_profile=_ezAllowed(tcdata,"5");window.ezTcfConsent.measure_ad_performance=_ezAllowed(tcdata,"7");window.ezTcfConsent.use_limited_data_to_select_content=_ezAllowed(tcdata,"11");window.ezTcfConsent.select_personalized_content=_ezAllowed(tcdata,"6");window.ezTcfConsent.understand_audiences=_ezAllowed(tcdata,"9");window._emitEzConsentEvent();}
function _handleGoogleConsentV2(tcdata){if(!tcdata||!tcdata.purpose||!tcdata.purpose.consents){return;}
var googConsentV2={};if(tcdata.purpose.consents[1]){googConsentV2.ad_storage='granted';googConsentV2.analytics_storage='granted';}
if(tcdata.purpose.consents[3]&&tcdata.purpose.consents[4]){googConsentV2.ad_personalization='granted';}
if(tcdata.purpose.consents[1]&&tcdata.purpose.consents[7]){googConsentV2.ad_user_data='granted';}
if(googConsentV2.analytics_storage=='denied'){gtag('set','url_passthrough',true);}
gtag('consent','update',googConsentV2);}
__tcfapi("addEventListener",2,function(tcdata,success){if(!success||!tcdata){window._emitEzConsentEvent();return;}
if(!tcdata.gdprApplies){_setAllEzConsentTrue();window._emitEzConsentEvent();return;}
if(tcdata.eventStatus==="useractioncomplete"||tcdata.eventStatus==="tcloaded"){if(typeof gtag!='undefined'){_handleGoogleConsentV2(tcdata);}
_handleConsentDecision(tcdata);if(tcdata.purpose.consents["1"]===true&&tcdata.vendor.consents["755"]!==false){window.ezgconsent=true;(adsbygoogle=window.adsbygoogle||[]).pauseAdRequests=0;}
if(window.__ezconsent){__ezconsent.setEzoicConsentSettings(ezConsentCategories);}
__tcfapi("removeEventListener",2,function(success){return null;},tcdata.listenerId);if(!(tcdata.purpose.consents["1"]===true&&_ezAllowed(tcdata,"2")&&_ezAllowed(tcdata,"3")&&_ezAllowed(tcdata,"4"))){if(typeof __ez=="object"&&typeof __ez.bit=="object"&&typeof window["_ezaq"]=="object"&&typeof window["_ezaq"]["page_view_id"]=="string"){__ez.bit.Add(window["_ezaq"]["page_view_id"],[new __ezDotData("non_personalized_ads",true),]);}}}});}else{_setAllEzConsentTrue();window._emitEzConsentEvent();}})(window,document);</script></body>
<!-- Mirrored from overiq.com/django-1-11/building-djangobin-the-first-steps/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 01 Feb 2025 11:14:13 GMT -->
</html>