<!DOCTYPE html><html lang="en">
<!-- Mirrored from overiq.com/django-1-10/django-form-basics/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 01 Feb 2025 11:04:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset="utf-8"/>
<script>var __ezHttpConsent={setByCat:function(src,tagType,attributes,category,force){var setScript=function(){if(force||window.ezTcfConsent[category]){var scriptElement=document.createElement(tagType);scriptElement.src=src;attributes.forEach(function(attr){for(var key in attr){if(attr.hasOwnProperty(key)){scriptElement.setAttribute(key,attr[key]);}}});var firstScript=document.getElementsByTagName(tagType)[0];firstScript.parentNode.insertBefore(scriptElement,firstScript);}};if(force||(window.ezTcfConsent&&window.ezTcfConsent.loaded)){setScript();}else if(typeof getEzConsentData==="function"){getEzConsentData().then(function(ezTcfConsent){if(ezTcfConsent&&ezTcfConsent.loaded){setScript();}else{console.error("cannot get ez consent data");force=true;setScript();}});}else{force=true;setScript();console.error("getEzConsentData is not a function");}},};</script>
<script>var ezTcfConsent=window.ezTcfConsent?window.ezTcfConsent:{loaded:false,store_info:false,develop_and_improve_services:false,measure_ad_performance:false,measure_content_performance:false,select_basic_ads:false,create_ad_profile:false,select_personalized_ads:false,create_content_profile:false,select_personalized_content:false,understand_audiences:false,use_limited_data_to_select_content:false,};function getEzConsentData(){return new Promise(function(resolve){document.addEventListener("ezConsentEvent",function(event){var ezTcfConsent=event.detail.ezTcfConsent;resolve(ezTcfConsent);});});}</script>
<script>if(typeof _setEzCookies!=='function'){function _setEzCookies(ezConsentData){var cookies=window.ezCookieQueue;for(var i=0;i<cookies.length;i++){var cookie=cookies[i];if(ezConsentData&&ezConsentData.loaded&&ezConsentData[cookie.tcfCategory]){document.cookie=cookie.name+"="+cookie.value;}}}}
window.ezCookieQueue=window.ezCookieQueue||[];if(typeof addEzCookies!=='function'){function addEzCookies(arr){window.ezCookieQueue=[...window.ezCookieQueue,...arr];}}
addEzCookies([]);if(window.ezTcfConsent&&window.ezTcfConsent.loaded){_setEzCookies(window.ezTcfConsent);}else if(typeof getEzConsentData==="function"){getEzConsentData().then(function(ezTcfConsent){if(ezTcfConsent&&ezTcfConsent.loaded){_setEzCookies(window.ezTcfConsent);}else{console.error("cannot get ez consent data");_setEzCookies(window.ezTcfConsent);}});}else{console.error("getEzConsentData is not a function");_setEzCookies(window.ezTcfConsent);}</script>
<script data-ezscrex='false' data-cfasync='false' data-pagespeed-no-defer>var __ez=__ez||{};__ez.stms=Date.now();__ez.evt={};__ez.script={};__ez.ck=__ez.ck||{};__ez.template={};__ez.template.isOrig=true;window.__ezScriptHost="//www.ezojs.com";__ez.queue=__ez.queue||function(){var e=0,i=0,t=[],n=!1,o=[],r=[],s=!0,a=function(e,i,n,o,r,s,a){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:window,d=this;this.name=e,this.funcName=i,this.parameters=null===n?null:w(n)?n:[n],this.isBlock=o,this.blockedBy=r,this.deleteWhenComplete=s,this.isError=!1,this.isComplete=!1,this.isInitialized=!1,this.proceedIfError=a,this.fWindow=l,this.isTimeDelay=!1,this.process=function(){f("... func = "+e),d.isInitialized=!0,d.isComplete=!0,f("... func.apply: "+e);var i=d.funcName.split("."),n=null,o=this.fWindow||window;i.length>3||(n=3===i.length?o[i[0]][i[1]][i[2]]:2===i.length?o[i[0]][i[1]]:o[d.funcName]),null!=n&&n.apply(null,this.parameters),!0===d.deleteWhenComplete&&delete t[e],!0===d.isBlock&&(f("----- F'D: "+d.name),m())}},l=function(e,i,t,n,o,r,s){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:window,l=this;this.name=e,this.path=i,this.async=o,this.defer=r,this.isBlock=t,this.blockedBy=n,this.isInitialized=!1,this.isError=!1,this.isComplete=!1,this.proceedIfError=s,this.fWindow=a,this.isTimeDelay=!1,this.isPath=function(e){return"/"===e[0]&&"/"!==e[1]},this.getSrc=function(e){return void 0!==window.__ezScriptHost&&this.isPath(e)&&"banger.js"!==this.name?window.__ezScriptHost+e:e},this.process=function(){l.isInitialized=!0,f("... file = "+e);var i=this.fWindow?this.fWindow.document:document,t=i.createElement("script");t.src=this.getSrc(this.path),!0===o?t.async=!0:!0===r&&(t.defer=!0),t.onerror=function(){var e={url:window.location.href,name:l.name,path:l.path,user_agent:window.navigator.userAgent};"undefined"!=typeof _ezaq&&(e.pageview_id=_ezaq.page_view_id);var i=encodeURIComponent(JSON.stringify(e)),t=new XMLHttpRequest;t.open("GET/index.html","//g.ezoic.net/ezqlog?d="+i,!0),t.send(),f("----- ERR'D: "+l.name),l.isError=!0,!0===l.isBlock&&m()},t.onreadystatechange=t.onload=function(){var e=t.readyState;f("----- F'D: "+l.name),e&&!/loaded|complete/.test(e)||(l.isComplete=!0,!0===l.isBlock&&m())},i.getElementsByTagName("head")[0].appendChild(t)}},d=function(e,i){this.name=e,this.path="",this.async=!1,this.defer=!1,this.isBlock=!1,this.blockedBy=[],this.isInitialized=!0,this.isError=!1,this.isComplete=i,this.proceedIfError=!1,this.isTimeDelay=!1,this.process=function(){}};function c(e,i,n,s,a,d,c,u,f){var m=new l(e,i,n,s,a,d,c,f);!0===u?o[e]=m:r[e]=m,t[e]=m,h(m)}function h(e){!0!==u(e)&&0!=s&&e.process()}function u(e){if(!0===e.isTimeDelay&&!1===n)return f(e.name+" blocked = TIME DELAY!"),!0;if(w(e.blockedBy))for(var i=0;i<e.blockedBy.length;i++){var o=e.blockedBy[i];if(!1===t.hasOwnProperty(o))return f(e.name+" blocked = "+o),!0;if(!0===e.proceedIfError&&!0===t[o].isError)return!1;if(!1===t[o].isComplete)return f(e.name+" blocked = "+o),!0}return!1}function f(e){var i=window.location.href,t=new RegExp("[?&]ezq=([^&#]*)","i").exec(i);"1"===(t?t[1]:null)&&console.debug(e)}function m(){++e>200||(f("let's go"),p(o),p(r))}function p(e){for(var i in e)if(!1!==e.hasOwnProperty(i)){var t=e[i];!0===t.isComplete||u(t)||!0===t.isInitialized||!0===t.isError?!0===t.isError?f(t.name+": error"):!0===t.isComplete?f(t.name+": complete already"):!0===t.isInitialized&&f(t.name+": initialized already"):t.process()}}function w(e){return"[object Array]"==Object.prototype.toString.call(e)}return window.addEventListener("load",(function(){setTimeout((function(){n=!0,f("TDELAY -----"),m()}),5e3)}),!1),{addFile:c,addFileOnce:function(e,i,n,o,r,s,a,l,d){t[e]||c(e,i,n,o,r,s,a,l,d)},addDelayFile:function(e,i){var n=new l(e,i,!1,[],!1,!1,!0);n.isTimeDelay=!0,f(e+" ...  FILE! TDELAY"),r[e]=n,t[e]=n,h(n)},addFunc:function(e,n,s,l,d,c,u,f,m,p){!0===c&&(e=e+"_"+i++);var w=new a(e,n,s,l,d,u,f,p);!0===m?o[e]=w:r[e]=w,t[e]=w,h(w)},addDelayFunc:function(e,i,n){var o=new a(e,i,n,!1,[],!0,!0);o.isTimeDelay=!0,f(e+" ...  FUNCTION! TDELAY"),r[e]=o,t[e]=o,h(o)},items:t,processAll:m,setallowLoad:function(e){s=e},markLoaded:function(e){if(e&&0!==e.length){if(e in t){var i=t[e];!0===i.isComplete?f(i.name+" "+e+": error loaded duplicate"):(i.isComplete=!0,i.isInitialized=!0)}else t[e]=new d(e,!0);f("markLoaded dummyfile: "+t[e].name)}},logWhatsBlocked:function(){for(var e in t)!1!==t.hasOwnProperty(e)&&u(t[e])}}}();__ez.evt.add=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n()},__ez.evt.remove=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):delete e["on"+t]};__ez.script.add=function(e){var t=document.createElement("script");t.src=e,t.async=!0,t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t)};__ez.dot={};__ez.queue.addFile('../../detroitchicago/boise.js', '../../detroitchicago/boisebb26.js?gcb=195-3&amp;cb=5', true, [], true, false, true, false);__ez.queue.addFile('../../parsonsmaize/abilene.js', '../../parsonsmaize/abilenec0f9.js?gcb=195-3&amp;cb=7f81d60744', true, [], true, false, true, false);__ez.queue.addFile('../../parsonsmaize/mulvane.js', '../../parsonsmaize/mulvane2d63.js?gcb=195-3&amp;cb=e75e48eec0', true, ['/parsonsmaize/abilene.js'], true, false, true, false);__ez.queue.addFile('../../detroitchicago/birmingham.js', '../../detroitchicago/birminghame7ec.js?gcb=195-3&amp;cb=539c47377c', true, ['/parsonsmaize/abilene.js'], true, false, true, false);</script>
<script data-ezscrex="false" type="text/javascript" data-cfasync="false">window._ezaq = Object.assign({"ad_cache_level":1,"adpicker_placement_cnt":0,"ai_placeholder_cache_level":1,"ai_placeholder_placement_cnt":-1,"domain_id":92771,"ezcache_level":1,"ezcache_skip_code":0,"has_bad_image":0,"has_bad_words":0,"is_sitespeed":0,"lt_cache_level":0,"response_size":110603,"response_size_orig":104835,"response_time_orig":514,"template_id":5,"url":"https://overiq.com/django-1-10/django-form-basics/","word_count":0,"worst_bad_word_level":0}, typeof window._ezaq !== "undefined" ? window._ezaq : {});__ez.queue.markLoaded('ezaqBaseReady');</script>
<script type='text/javascript' data-ezscrex='false' data-cfasync='false'>
window.ezAnalyticsStatic = true;

function analyticsAddScript(script) {
	var ezDynamic = document.createElement('script');
	ezDynamic.type = 'text/javascript';
	ezDynamic.innerHTML = script;
	document.head.appendChild(ezDynamic);
}
function getCookiesWithPrefix() {
    var allCookies = document.cookie.split(';');
    var cookiesWithPrefix = {};

    for (var i = 0; i < allCookies.length; i++) {
        var cookie = allCookies[i].trim();

        for (var j = 0; j < arguments.length; j++) {
            var prefix = arguments[j];
            if (cookie.indexOf(prefix) === 0) {
                var cookieParts = cookie.split('=');
                var cookieName = cookieParts[0];
                var cookieValue = cookieParts.slice(1).join('=');
                cookiesWithPrefix[cookieName] = decodeURIComponent(cookieValue);
                break; // Once matched, no need to check other prefixes
            }
        }
    }

    return cookiesWithPrefix;
}
function productAnalytics() {
	var d = {"pr":[6],"omd5":"b7877a7dfa96c0933f7c78d4d6d0bbb0"};
	d.u = _ezaq.url;
	d.p = _ezaq.page_view_id;
	d.v = _ezaq.visit_uuid;
	d.ab = _ezaq.ab_test_id;
	d.e = JSON.stringify(_ezaq);
	d.ref = document.referrer;
	d.c = getCookiesWithPrefix('active_template', 'ez', 'lp_');
	if(typeof ez_utmParams !== 'undefined') {
		d.utm = ez_utmParams;
	}

	var dataText = JSON.stringify(d);
	var xhr = new XMLHttpRequest();
	xhr.open('POST/index.html','/ezais/analytics?cb=1', true);
	xhr.onload = function () {
		if (xhr.status!=200) {
            return;
		}

        if(document.readyState !== 'loading') {
            analyticsAddScript(xhr.response);
            return;
        }

        var eventFunc = function() {
            if(document.readyState === 'loading') {
                return;
            }
            document.removeEventListener('readystatechange', eventFunc, false);
            analyticsAddScript(xhr.response);
        };

        document.addEventListener('readystatechange', eventFunc, false);
	};
	xhr.setRequestHeader('Content-Type','text/plain');
	xhr.send(dataText);
}
__ez.queue.addFunc("productAnalytics", "productAnalytics", null, true, ['ezaqBaseReady'], false, false, false, true);
</script><base />
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <title>Django Form Basics - Django 1.10 Tutorial - OverIQ.com</title>

    
    



    <meta name="description" content="The syntax of creating forms in Django is almost similar to that of creating models, the only differences are:


Django form inherits from forms.Form…"/>



    <link rel="canonical" href="index.html"/>


<meta property="og:locale" content="en_US"/>
<meta property="og:type" content="article"/>
<meta property="og:title" content="Django Form Basics"/>

    <meta property="og:description" content="The syntax of creating forms in Django is almost similar to that of creating models, the only differences are:


Django form inherits from forms.Form…"/>


<meta property="og:url" content="https://overiq.com/django-1-10/django-form-basics/"/>
<meta property="og:site_name" content="OverIQ.com"/>


<meta property="article:publisher" content="https://www.facebook.com/OverIQ/"/>



<meta name="twitter:card" content="summary_large_image"/>

    <meta name="twitter:description" content="The syntax of creating forms in Django is almost similar to that of creating models, the only differences are:


Django form inherits from forms.Form…"/>


<meta name="twitter:title" content="Django Form Basics"/>
<meta name="twitter:site" content="@infoOverIQ"/>

<meta name="twitter:creator" content="@infoOverIQ"/>




    
    
    


    
    
    


    <link rel="alternate" type="application/rss+xml" title="RSS" href="../../feed.xml/index.html"/>
    
    
    <link href="../../../fonts.googleapis.com/cssd2d5.css?family=Open+Sans" rel="stylesheet"/>
    <link rel="stylesheet" href="../../../maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="icon" href="../../static/wiki/favicon.png" sizes="32x32"/>

    <link rel="stylesheet" href="../../static/CACHE/css/output.db46da465a8b.css" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-125424793-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-125424793-1');
    </script>


<script type='text/javascript'>
var ezoTemplate = 'orig_site';
var ezouid = '1';
var ezoFormfactor = '1';
</script><script data-ezscrex="false" type='text/javascript'>
var soc_app_id = '0';
var did = 92771;
var ezdomain = 'overiq.com';
var ezoicSearchable = 1;
</script></head>
<body>

<div class="overiq-header text-center">
    <div class="site-branding">
        <p class="main-title">
            <a href="../../index.html" rel="home">
                OverIQ.com
            </a>
        </p>
    </div>
</div>

<!-- Navigation -->
<nav class="navbar navbar-inverse" role="navigation">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../index.html">Home</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                

                <li>
                    <a href="../../blog/index.html">Blog</a>
                </li>
                <li>
                    <a href="../../contact/index.html">Contact</a>
                </li>
                <li>
                    <a href="../../about/index.html">About</a>
                </li>
            </ul>

            <ul class="nav navbar-nav navbar-right visible-lg visible-md">
                <li>
                    <a href="../../feed.xml/index.html" title="RSS" target="_blank">
                        <i class="fa fa-rss fa-lg" aria-hidden="true"></i>
                    </a>
                </li>
                <li>
                    <a href="https://github.com/overiq/" target="_blank" title="Github">
                        <i class="fa fa-github fa-lg" aria-hidden="true"></i>
                    </a>
                </li>
                <li>
                    <a href="https://www.facebook.com/OverIQ/" target="_blank" title="Facebook">
                        <i class="fa fa-facebook fa-lg" aria-hidden="true"></i>
                    </a>
                </li>
                <li>
                    <a href="https://twitter.com/infoOverIQ" target="_blank" title="Twitter">
                        <i class="fa fa-twitter fa-lg" aria-hidden="true"></i>
                    </a>
                </li>

                

            </ul>

            <form action="https://overiq.com/search/" class="navbar-form navbar-left" role="search">

                <div class="form-group">
                    <input type="text" class="form-control" placeholder="Search" name="query" value=""/>
                </div>

                <button type="submit" class="btn btn-default">Submit</button>
            </form>

        </div>



        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

<div class="container">

    


    <div class="se-pre-con"></div>

    

    <div class="row">

        
        <div class="main">
            <div class="col-lg-8 col-md-8 col-sm-12">
                

    


    
        <ol class="breadcrumb">

    <li><a href="../../index.html">Home</a></li>

    
        
        <li><a href="../index.html">Django 1.10 Tutorial</a></li>
        

        

        
    
        

        

        
            <li class="active">Django Form Basics</li>
        
    

</ol>
    


<h1>Django Form Basics</h1>




    <p><i class="fa fa-calendar" aria-hidden="true"></i>
        Last updated on July 27, 2020
    </p>


<hr/>



<p>The syntax of creating forms in Django is almost similar to that of creating models, the only differences are:</p>

<ol>
<li>Django form inherits from <code>forms.Form</code> instead of <code>models.Model</code>.</li>
<li>Each form fields inherit <code>forms.FieldName</code> instead of <code>models.FieldName</code>.</li>
</ol>

<p>Let&#39;s start off by creating an <code>AuthorForm</code> class.</p>

<p>Create a new file called <code>forms.py</code>, if not already exists in the blog app i.e <code>TGDB/django_project/blog</code> (same place where <code>models.py</code> file is located) and add the following code to it.</p>

<p><strong>TGDB/django_project/blog/forms.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>


<span class="k">class</span> <span class="nc">AuthorForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span>
    <span class="n">active</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c1"># required=False makes the field optional</span>
    <span class="n">created_on</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">()</span>
    <span class="n">last_logged_in</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">()</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Form fields are similar to model fields in the following ways:</p>

<ol>
<li>Both correspond to a Python type.</li>
<li>Both validate data in the form.</li>
<li>Both fields are required by default.</li>
<li>Both types of fields know how to represent them in the templates as HTML. Every form fields are displayed in the browser as an HTML widget. Each form field is assigned a reasonable Widget class, but you can also override this setting.</li>
</ol>

<p>Here is an important difference between the model fields and form fields.</p>

<p>Model fields know how to represent themselves in the database whereas form fields do not.</p>
<span id="form-states" class="anchor-target"></span><h2 class="heading">Form States <a class="header-link" href="#form-states">#</a></h2>

<p>A form in Django can be either in a Bound state or Unbound state. What is Bound and Unbound state?</p>

<p><strong>Unbound State:</strong> In Unbound state the form has no data associated with it. For example, an empty form displayed for the first time is in unbound state.</p>

<p><strong>Bound State:</strong> The act of giving data to the form is called binding a form. A form is in the bound state if it has user submitted data. It doesn&#39;t matter whether the data is valid or not.</p>

<p>If the form is in bound state but contains invalid data then the form is bound and invalid. On the other hand, if the form is bound and data is valid then the form is bound and valid.</p>
<span id="is_bound-attribute-and-is_valid-method" class="anchor-target"></span><h2 class="heading">is_bound attribute and is_valid() method <a class="header-link" href="#is_bound-attribute-and-is_valid-method">#</a></h2>

<p>We can use <code>is_bound</code> attribute to know whether the form is inbound state or not. If the form is in the bound state then the <code>is_bound</code> returns <code>True</code>, otherwise <code>False</code>.</p>

<p>Similarly, we can use the <code>is_valid()</code> method to check whether the entered data is valid or not. If the data is valid then <code>is_valid()</code> returns <code>True</code>, otherwise <code>False</code>. It is important to note that if <code>is_valid()</code> returns <code>True</code> then <code>is_bound</code> attribute is bound to return <code>True</code>.</p>
<span id="accessing-cleaned-data" class="anchor-target"></span><h2 class="heading">Accessing Cleaned Data <a class="header-link" href="#accessing-cleaned-data">#</a></h2>

<p>When a user enter submits the data via form Django first validate and clean the data. Does this mean that the data entered by the user were not clean? Yes, for the two good reasons:</p>

<ol>
<li><p>When it comes to submitting data using forms you must never trust the user. It takes a single malicious user to wreak havoc on your site. That&#39;s why Django validates the form data before you can use them.</p></li>
<li><p>Any data the user submits through a form will be passed to the server as strings. It doesn&#39;t matter which type of form field was used to create the form. Eventually, the browser would will everything as strings. When Django cleans the data it automatically converts data to the appropriate type. For example <code>IntegerField</code> data would be converted to an integer, <code>CharField</code> data would be converted to a string, <code>BooleanField</code> data would be converted to a bool i.e <code>True</code> or <code>False</code> and so on. In Django, this cleaned and validated data is commonly known as <strong>cleaned data</strong>. We can access cleaned data via <code>cleaned_data</code> dictionary:</p>
<div class="codeblock language-python"><div class="highlight"><pre><span></span><span class="n">cleaned_date</span><span class="p">[</span><span class="s1">&#39;field_name&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>You must never access the data directly using <code>self.field_name</code> as it may not be safe.</p></li>
</ol>
<span id="django-forms-in-django-shell" class="anchor-target"></span><h2 class="heading">Django Forms in Django Shell <a class="header-link" href="#django-forms-in-django-shell">#</a></h2>

<p>In this section we will learn how to bind data and validate a form using Django Shell. Start Django Shell by typing <code>python manage.py shell</code> command in the command prompt or terminal. Next, import the <code>AuthorForm</code> class and instantiate a <code>AuthorForm</code> object:</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">env</span><span class="p">)</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Q</span>\<span class="n">TGDB</span>\<span class="n">django_project</span><span class="o">&gt;</span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">shell</span>
<span class="n">Python</span> <span class="mf">3.4</span><span class="o">.</span><span class="mi">4</span> <span class="p">(</span><span class="n">v3</span><span class="o">.</span><span class="mf">4.4</span><span class="p">:</span><span class="mi">737</span><span class="n">efcadf5a6</span><span class="p">,</span> <span class="n">Dec</span> <span class="mi">20</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">57</span><span class="p">)</span> <span class="p">[</span><span class="n">MSC</span> <span class="n">v</span><span class="o">.</span><span class="mi">1600</span> <span class="mi">64</span> <span class="n">bit</span> <span class="p">(</span><span class="n">AM</span>
<span class="n">D64</span><span class="p">)]</span> <span class="n">on</span> <span class="n">win32</span>
<span class="n">Type</span> <span class="s2">&#34;help&#34;</span><span class="p">,</span> <span class="s2">&#34;copyright&#34;</span><span class="p">,</span> <span class="s2">&#34;credits&#34;</span> <span class="ow">or</span> <span class="s2">&#34;license&#34;</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>
<span class="p">(</span><span class="n">InteractiveConsole</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">blog.forms</span> <span class="kn">import</span> <span class="n">AuthorForm</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">AuthorForm</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>At this point, our form object i.e <code>f</code> is unbound because there is no data in the form. We can verify this fact by using <code>is_bound</code> attribute.</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">is_bound</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>As expected <code>is_bound</code> attribute returns <code>False</code>. We can also check whether the form is valid or not by calling <code>is_valid()</code> method.</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>It is important to understand that <code>is_bound</code> and <code>is_valid()</code> are related. If <code>is_bound</code> is <code>False</code> then <code>is_valid()</code> will always return <code>False</code> no matter what. Similarly, if <code>is_valid()</code> returns <code>True</code> then <code>is_bound</code> must be <code>True</code>.</p>

<p>Calling <code>is_valid()</code> method results in validation and cleaning of the form data. In the process, Django creates an attribute called <code>cleaned_data</code>, a dictionary which contains cleaned data only from the fields which have passed the validation tests. Note that <code>cleaned_data</code> attribute will only be available to you after you have invoked the <code>is_valid()</code> method. Trying to access <code>cleaned_data</code> before invoking <code>is_valid()</code> will throw an <code>AttributeError</code> exception.</p>

<p>Obviously, now the question arises &#34;How do we bind data to the form&#34;?</p>

<p>To bind data to a form simply pass a dictionary as an argument to the form class(in this case <code>AuthorForm</code>) while creating a new form object.</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="o">...</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;jon&#39;</span><span class="p">,</span>
<span class="o">...</span> <span class="s1">&#39;created_on&#39;</span><span class="p">:</span> <span class="s1">&#39;today&#39;</span><span class="p">,</span>
<span class="o">...</span> <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
<span class="o">...</span> <span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">AuthorForm</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Our form object <code>f</code> has data now, so we can say that it is bound. Let&#39;s verify that by using <code>is_bound</code> attribute.</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">is_bound</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>As expected, our form is bound now. We could also get a bound form by passing an empty dictionary (<code>{}</code>).</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f2</span> <span class="o">=</span> <span class="n">AuthorForm</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f2</span><span class="o">.</span><span class="n">is_bound</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Okay let&#39;s now try accessing <code>cleaned_data</code> attribute before invoking <code>is_valid()</code> method.</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">cleaned_data</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&#34;&lt;console&gt;&#34;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">AttributeError</span><span class="p">:</span> <span class="s1">&#39;CategoryForm&#39;</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">&#39;cleaned_data&#39;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>As expected, we got an <code>AttributeError</code> exception. Now we will validate the form by calling <code>is_valid()</code> method.</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">cleaned_data</span>
<span class="p">{</span><span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;jon&#39;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Our validation fails but we now have <code>cleaned_data</code> dictionary available. Notice that there is no <code>created_on</code> key in the <code>cleaned_data</code> dictionary because Django failed to validate this field. In addition to that, the form validation also failed to validate <code>email</code> and <code>last_logged_in</code> field of the <code>AuthorForm</code> because we haven&#39;t provided any data to it.</p>

<p>Always remember that the <code>cleaned_data</code> attribute will only contain validated and cleaned data, nothing else.</p>

<p>To access errors, the form object provides an <code>errors</code> attribute which is an object of type <code>ErrorDict</code>, but for the most part you can use it as a dictionary. Here is how it works:</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">errors</span>
<span class="p">{</span><span class="s1">&#39;created_on&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Enter a valid date/time.&#39;</span><span class="p">],</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;This field is required.&#39;</span>
<span class="p">],</span> <span class="s1">&#39;last_logged_in&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;This field is required.&#39;</span><span class="p">]}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Notice that there are three fields which failed the validation process. By default, <code>f.errors</code> returns error messages for all the fields which failed to pass validation. Here is how to get the error message for a particular field.</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;This field is required.&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="s1">&#39;created_on&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;Enter a valid date/time.&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="s1">&#39;last_logged_in&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;This field is required.&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>The <code>errors</code> object provides two methods to ouput errors in different formats:</p>
<div style="overflow-x:auto"><table class="table table-bordered table-hover table-condensed"><thead>
<tr>
<th>Method</th>
<th>Explanation</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>as_data()</code></td>
<td>returns a dictionary with <code>ValidationError</code> object instead of a string.</td>
</tr>
<tr>
<td><code>as_json()</code></td>
<td>returns errors as JSON</td>
</tr>
</tbody>
</table></div><div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">errors</span>
<span class="p">{</span><span class="s1">&#39;created_on&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Enter a valid date/time.&#39;</span><span class="p">],</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;This field is required.&#39;</span>
<span class="p">],</span> <span class="s1">&#39;last_logged_in&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;This field is required.&#39;</span><span class="p">]}</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div><div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">as_data</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;created_on&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">ValidationError</span><span class="p">([</span><span class="s1">&#39;Enter a valid date/time.&#39;</span><span class="p">])],</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">Valida</span>
<span class="n">tionError</span><span class="p">([</span><span class="s1">&#39;This field is required.&#39;</span><span class="p">])],</span> <span class="s1">&#39;last_logged_in&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">ValidationError</span><span class="p">([</span><span class="s1">&#39;Th</span>
<span class="ow">is</span> <span class="n">field</span> <span class="ow">is</span> <span class="n">required</span><span class="o">.</span><span class="s1">&#39;])]}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div><div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">as_json</span><span class="p">()</span>
<span class="s1">&#39;{&#34;created_on&#34;: [{&#34;code&#34;: &#34;invalid&#34;, &#34;message&#34;: &#34;Enter a valid date/time.&#34;}], &#34;e</span>
<span class="n">mail</span><span class="s2">&#34;: [{&#34;</span><span class="n">code</span><span class="s2">&#34;: &#34;</span><span class="n">required</span><span class="s2">&#34;, &#34;</span><span class="n">message</span><span class="s2">&#34;: &#34;</span><span class="n">This</span> <span class="n">field</span> <span class="ow">is</span> <span class="n">required</span><span class="o">.</span><span class="s2">&#34;}], &#34;</span><span class="n">last_logge</span>
<span class="n">d_in</span><span class="s2">&#34;: [{&#34;</span><span class="n">code</span><span class="s2">&#34;: &#34;</span><span class="n">required</span><span class="s2">&#34;, &#34;</span><span class="n">message</span><span class="s2">&#34;: &#34;</span><span class="n">This</span> <span class="n">field</span> <span class="ow">is</span> <span class="n">required</span><span class="o">.</span><span class="s2">&#34;}]}&#39;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Note that unlike the <code>cleaned_data</code> attribute the <code>errors</code> attribute is available to you all the time without first calling the <code>is_valid()</code> method. But there is a caveat, trying to access <code>errors</code> attribute before calling <code>is_valid()</code> method results in validation and cleaning of form data first, consequently creating <code>cleaned_data</code> attribute in the process. In other words, trying to access <code>errors</code> attribute first will result in a call to <code>is_valid()</code> method implicitly. However, in your code should always call <code>is_valid()</code> method explicitly.</p>

<p>To demonstrate the whole process one more time, let&#39;s create another form object, but this time we will bind the form with data that will pass the validation.</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">datetime</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="o">...</span>  <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;tim&#39;</span><span class="p">,</span>
<span class="o">...</span>  <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;tim@mail.com&#39;</span><span class="p">,</span>
<span class="o">...</span>  <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
<span class="o">...</span>  <span class="s1">&#39;created_on&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
<span class="o">...</span>  <span class="s1">&#39;last_logged_in&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="o">...</span> <span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">AuthorForm</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">is_bound</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">cleaned_data</span>
<span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;tim&#39;</span><span class="p">,</span> <span class="s1">&#39;created_on&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">433661</span><span class="p">,</span>
 <span class="n">tzinfo</span><span class="o">=&lt;</span><span class="n">UTC</span><span class="o">&gt;</span><span class="p">),</span> <span class="s1">&#39;last_logged_in&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">433</span>
<span class="mi">661</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=&lt;</span><span class="n">UTC</span><span class="o">&gt;</span><span class="p">),</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;tim@mail.com&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">errors</span>
<span class="p">{}</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div><span id="digging-deep-into-form-validation" class="anchor-target"></span><h2 class="heading">Digging deep into Form Validation <a class="header-link" href="#digging-deep-into-form-validation">#</a></h2>

<p>When <code>is_valid()</code> method is called Django does the following things behind the scenes:</p>

<ol>
<li><p>The first step is to call Field&#39;s <code>clean()</code> method. Every form field has a <code>clean()</code> method, which does the following two things:</p>

<ol>
<li><p>Convert the field data (recall that the data is sent by the browser as a  string to the server) to the appropriate Python type. For example, if the field is defined as <code>IntegerField</code> then the <code>clean()</code> method will convert the data to Python <code>int</code>, if it fails to do so, it raises a <code>ValidationError</code> exception.</p></li>
<li><p>Validate the converted data received from the step 1. If validation succeeds, cleaned and validated data is inserted into the <code>cleaned_data</code> attribute. If it fails a <code>ValidationError</code> is raised. We usually don&#39;t override field&#39;s <code>clean()</code> method.</p></li>
</ol></li>
<li><p>In step 2, Field&#39;s <code>clean_&lt;fieldname&gt;()</code> method is called to provide some additional validation to the field. Notice that <code>&lt;fieldname&gt;</code> is a placeholder, it is not an actual Python method. By default, Django doesn&#39;t define these methods. These methods are usually written by developers to provide some additional validation to the field. They do not accept any arguments, but they must return the new value of the field. This method is called only when <code>ValidationError</code> is not raised by the Field&#39;s <code>clean()</code> method. That means, if this method is called, it is guaranteed that the field&#39;s data is cleaned and validated. Consequently, you must always access field&#39;s data inside this method using <code>cleaned_data[&#39;fieldname&#39;]</code>. The value returned by this method replaces the existing value of the field in the <code>cleaned_data</code> dictionary.</p></li>
</ol>

<p>Django repeats step 1 and 2 for all form fields.</p>

<p>Finally, Form&#39;s class <code>clean()</code> method is called. If you want to perform validation which requires access to multiple fields override this method in your form class.</p>

<p><strong>Note:</strong> This is an oversimplified view of Django Validation Process. The reality is much more involved but that&#39;s enough, to begin with.</p>

<p>Let&#39;s take an example to understand how Django performs cleaning and validation when <code>is_valid()</code> method is called on <code>AuthorForm</code> class.</p>

<p><strong>1st step -</strong> The <code>name</code> field&#39;s <code>clean()</code> method is called to clean and validate data. On success, it puts the clean and validated data into the <code>cleaned_data</code> dictionary. If cleaning or validation failed <code>ValidationError</code> exception is raised and call to <code>clean_name()</code> is skipped. Nonetheless, the <code>clean()</code> method of the following field will be called.</p>

<p><strong>2nd step -</strong> The <code>name</code> field&#39;s <code>clean_name()</code> method is called (assuming this method is defined in the form class and <code>ValidationError</code> is not raised in step 1) to perform some additional validations.</p>

<p><strong>3rd step -</strong> The <code>email</code> field&#39;s <code>clean()</code> method is called to clean and validate data. On success, it puts the clean and validated data into the <code>cleaned_data</code> dictionary. If cleaning or validation failed <code>ValidationError</code> exception is raised and call to <code>clean_email()</code> method is skipped. Nonetheless, the <code>clean()</code> method of the following field will be called.</p>

<p><strong>4th step -</strong> The <code>email</code> field&#39;s <code>clean_email()</code> is a method called (assuming this method is defined in the form class and <code>ValidationError</code> is not raised in step 3) to perform some additional validation. At this point, it is guaranteed that <code>email</code> field is cleaned and validated, so the following code is perfectly valid inside <code>clean_email()</code> method.</p>
<div class="codeblock language-python"><div class="highlight"><pre><span></span><span class="n">email</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">];</span> <span class="c1">## that&#39;s okay</span>
</pre></div>
</div>
<p>However, there is no guarantee that the data from other fields, for example, the name field is available inside <code>clean_email()</code> method. So, you should not attempt to access <code>name</code> field inside <code>clean_email()</code> method like this:</p>
<div class="codeblock language-python"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span> <span class="c1"># Not good, you may get an error for doing this</span>
</pre></div>
</div>
<p>If you want to provide additional validation to the <code>name</code> field, do it in the <code>clean_name()</code> method because it is guaranteed to be available there.</p>

<p>This process repeats for every form field. At last, Form&#39;s <code>clean()</code> method or its override is called. An important thing to remember about the Form&#39;s <code>clean()</code> method is that none of the fields is guaranteed to exists here. To access field data you must always use dictionary&#39;s object <code>get()</code> method like this:</p>
<div class="codeblock language-python"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If the <code>name</code> key is not available in the <code>cleaned_data</code> dictionary then <code>get()</code> method will return <code>None</code>.</p>
<span id="implementing-custom-validators" class="anchor-target"></span><h2 class="heading">Implementing Custom Validators <a class="header-link" href="#implementing-custom-validators">#</a></h2>

<p>In this section, we are going to implement some custom validators in our <code>AuthorForm</code> class. Here are things we want to achieve.</p>

<ol>
<li>Prevent users to create Author named <code>&#34;admin&#34;</code> and <code>&#34;author&#34;</code>.</li>
<li>Save the email in lowercase only. At this point, nothing is stopping us to save the email in uppercase.</li>
</ol>

<p>Open <code>forms.py</code> and modify the code as follows:</p>

<p><strong>TGDB/django_project/blog/forms.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="hll"><span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span>
</span>

<span class="k">class</span> <span class="nc">AuthorForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="c1">#...</span>
    <span class="n">last_logged_in</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">()</span>

<span class="hll">    <span class="k">def</span> <span class="nf">clean_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span><span class="hll">        <span class="n">name_l</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span class="hll">        <span class="k">if</span> <span class="n">name_l</span> <span class="o">==</span> <span class="s2">&#34;admin&#34;</span> <span class="ow">or</span> <span class="n">name_l</span> <span class="o">==</span> <span class="s2">&#34;author&#34;</span><span class="p">:</span>
</span><span class="hll">            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&#34;Author name can&#39;t be &#39;admin/author&#39;&#34;</span><span class="p">)</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">name_l</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">clean_email</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span></pre></div>
</td></tr></tbody></table></div>
<p>Restart the Django shell for the changes to take effect and then enter the following code. Here we are trying to validate a form where author name is <code>&#34;author&#34;</code>.</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">blog.forms</span> <span class="kn">import</span> <span class="n">AuthorForm</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">datetime</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="o">...</span>  <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;author&#39;</span><span class="p">,</span>
<span class="o">...</span>  <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;TIM@MAIL.COM&#39;</span><span class="p">,</span>
<span class="o">...</span>  <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
<span class="o">...</span>  <span class="s1">&#39;created_on&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
<span class="o">...</span>  <span class="s1">&#39;last_logged_in&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="o">...</span> <span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">AuthorForm</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">is_bound</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">cleaned_data</span>
<span class="p">{</span><span class="s1">&#39;last_logged_in&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">441359</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=&lt;</span><span class="n">UT</span>
<span class="n">C</span><span class="o">&gt;</span><span class="p">),</span> <span class="s1">&#39;created_on&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">441359</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=&lt;</span><span class="n">UT</span>
<span class="n">C</span><span class="o">&gt;</span><span class="p">),</span> <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;tim@mail.com&#39;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">errors</span>
<span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;Author name can&#39;t be &#39;admin/author&#39;&#34;</span><span class="p">]}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>As expected, form validation failed because <code>&#34;author&#34;</code> is not a valid author name. In addition to that <code>cleaned_data</code> contains <code>email</code> in lowercase, thanks to the <code>clean_email()</code> method.</p>

<p>Notice that form&#39;s <code>errors</code> attribute returns the same error message we specified in the <code>clean_name()</code> method. Let&#39;s try validating form data once more, this time we will provide valid data in every field.</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="o">...</span>  <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mike&#39;</span><span class="p">,</span>
<span class="o">...</span>  <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;mike@mail.com&#39;</span><span class="p">,</span>
<span class="o">...</span>  <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
<span class="o">...</span>  <span class="s1">&#39;created_on&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
<span class="o">...</span>  <span class="s1">&#39;last_logged_in&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="o">...</span>  <span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">AuthorForm</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">is_bound</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">cleaned_data</span>
<span class="p">{</span><span class="s1">&#39;last_logged_in&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">935625</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=&lt;</span><span class="n">UT</span>
<span class="n">C</span><span class="o">&gt;</span><span class="p">),</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mike&#39;</span><span class="p">,</span> <span class="s1">&#39;created_on&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">93</span>
<span class="mi">5625</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=&lt;</span><span class="n">UTC</span><span class="o">&gt;</span><span class="p">),</span> <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;mike@mail.com&#39;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">errors</span>
<span class="p">{}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>This time validation succeeds because data in every field is correct.</p>
<span id="saving-the-form-data-to-the-database" class="anchor-target"></span><h2 class="heading">Saving the form data to the database <a class="header-link" href="#saving-the-form-data-to-the-database">#</a></h2>

<p>So, how do we save data received via the form to the database? Earlier in this chapter, we have already discussed that unlike models fields, form fields don&#39;t know how to represent themselves in the database. Further, unlike <code>models.Model</code> class, the <code>forms.Form</code> class doesn&#39;t provide <code>save()</code> method to save the form data to the database.</p>

<p>The solution is to implement our own <code>save()</code> method. There is no restriction on method name you can call it anything you like. Open <code>forms.py</code> file and add <code>save()</code> method towards the end of <code>AuthorForm</code> class:</p>

<p><strong>TGDB/django_project/blog/forms.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span>
<span class="hll"><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Author</span><span class="p">,</span> <span class="n">Tag</span><span class="p">,</span> <span class="n">Category</span><span class="p">,</span> <span class="n">Post</span>
</span>

<span class="k">class</span> <span class="nc">AuthorForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="c1">#...</span>

    <span class="k">def</span> <span class="nf">clean_email</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

<span class="hll">    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="n">new_author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
</span><span class="hll">            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
</span><span class="hll">            <span class="n">email</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">],</span>
</span><span class="hll">            <span class="n">active</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">],</span>
</span><span class="hll">            <span class="n">created_on</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;created_on&#39;</span><span class="p">],</span>
</span><span class="hll">            <span class="n">last_logged_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;last_logged_in&#39;</span><span class="p">],</span>
</span><span class="hll">        <span class="p">)</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">new_author</span>
</span></pre></div>
</td></tr></tbody></table></div>
<p>Nothing new here, in line 3, we are importing models from the blog app. In lines 12-20, we are defining the <code>save()</code> method which uses form data to create a new <code>Author</code> object. Notice that while creating new <code>Author</code> object we are accessing form data via <code>cleaned_data</code> dictionary.</p>

<p>Restart the Django shell again and Let&#39;s try creating a new Author via <code>AuthorForm</code>.</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">blog.forms</span> <span class="kn">import</span> <span class="n">AuthorForm</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">datetime</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="o">...</span>  <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;jetson&#39;</span><span class="p">,</span>
<span class="o">...</span>  <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;jetson@mail.com&#39;</span><span class="p">,</span>
<span class="o">...</span>  <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
<span class="o">...</span>  <span class="s1">&#39;created_on&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
<span class="o">...</span>  <span class="s1">&#39;last_logged_in&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="o">...</span>  <span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">AuthorForm</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">is_bound</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">Author</span><span class="p">:</span> <span class="n">jetson</span> <span class="p">:</span> <span class="n">jetson</span><span class="nd">@mail.com</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">blog.models</span> <span class="kn">import</span> <span class="n">Author</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;jetson&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">pk</span>
<span class="mi">11</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span>
<span class="o">&lt;</span><span class="n">Author</span><span class="p">:</span> <span class="n">jetson</span> <span class="p">:</span> <span class="n">jetson</span><span class="nd">@mail.com</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Sure enough, our newly created category object is now saved in the database.</p>

<p>Our form is fully functional. At this point, we could move on to create form classes for the rest of the objects like Post, Tag etc; but there is a big problem.</p>

<p>The problem with this approach is that fields in the <code>AuthorForm</code> class map closely to that of <code>Author</code> models. As a result, redefining them in the <code>AuthorForm</code> is redundant. If we add or modify any field in the <code>Author</code> model then we would have to update our <code>AuthorForm</code> class accordingly.</p>

<p>Further, as you might have noticed there are few differences in the way we have defined model fields and form fields. For example:</p>

<p>The <code>email</code> field in <code>Author</code> model is defined like this:</p>
<div class="codeblock language-python"><div class="highlight"><pre><span></span><span class="n">email</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>On the other hand, the same field in <code>AuthorForm</code> is defined like this:</p>
<div class="codeblock language-python"><div class="highlight"><pre><span></span><span class="n">email</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span>
</pre></div>
</div>
<p>Notice that the <code>email</code> field in <code>AuthorForm</code> doesn&#39;t have <code>unique=True</code> attribute because <code>unique=True</code> attribute is only defined for the model fields, not for the form fields. One way to solve this problem is to create a custom validator by implementing <code>clean_email()</code> method like this:</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Author</span><span class="p">,</span> <span class="n">Tag</span><span class="p">,</span> <span class="n">Category</span><span class="p">,</span> <span class="n">Post</span>

<span class="k">class</span> <span class="nc">AuthorForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="c1">#...</span>

    <span class="k">def</span> <span class="nf">clean_email</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">email</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="n">email</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&#34;{0} already exists&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">email</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Similarly, Form fields don&#39;t provide default, <code>auto_add_now</code> and <code>auto_now</code> parameters. If you want to implement functionalities provided by these attributes then you would need the write custom validation method for each of these fields.</p>

<p>As you can see, for each functionality provided by the Django models, we would have to add various cleaning methods as well as custom validators. Certainly, this involves a lot of work. We can avoid all these issues by using <code>ModelForm</code>.</p>
<span id="removing-redundancy-using-modelform" class="anchor-target"></span><h2 class="heading">Removing redundancy using ModelForm <a class="header-link" href="#removing-redundancy-using-modelform">#</a></h2>

<p>The <code>ModelForm</code> class allows us to connect a <code>Form</code> class to the <code>Model</code> class.</p>

<p>To use <code>ModelForm</code> do the following:</p>

<ol>
<li>Change inheritance of the form class from <code>forms.Form</code> to <code>forms.ModelForm</code>.</li>
<li>Inform the form class in <code>forms.py</code> which model to use by using the <code>model</code> attribute of the <code>Meta</code> class.</li>
</ol>

<p>After these two steps, we can remove all the form fields we have defined in the <code>AuthorForm</code> class. Furthermore, we can remove the <code>save()</code> method too, because <code>ModelForm</code> provides this method. It is important to mention here that the <code>save()</code> method we implemented earlier in this chapter can only create objects, it can&#39;t update them. On the other hand, the <code>save()</code> method coming from <code>ModelForm</code> can do both.</p>

<p>Here is the modified code.</p>

<p><strong>TGDB/django_project/blog/forms.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Author</span><span class="p">,</span> <span class="n">Tag</span><span class="p">,</span> <span class="n">Category</span><span class="p">,</span> <span class="n">Post</span>


<span class="hll"><span class="k">class</span> <span class="nc">AuthorForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span><span class="hll">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span class="hll">        <span class="n">model</span> <span class="o">=</span> <span class="n">Author</span>        
</span>
    <span class="k">def</span> <span class="nf">clean_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="n">name_l</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name_l</span> <span class="o">==</span> <span class="s2">&#34;admin&#34;</span> <span class="ow">or</span> <span class="n">name_l</span> <span class="o">==</span> <span class="s2">&#34;author&#34;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&#34;Author name can&#39;t be &#39;admin/author&#39;&#34;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name_l</span>

    <span class="k">def</span> <span class="nf">clean_email</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</td></tr></tbody></table></div>
<p>There is still one thing missing in our <code>AuthorForm</code> class. We have to tell <code>AuthorForm</code> class which fields we want to show in the form. To do that we use <code>fields</code> attribute of the <code>Meta</code> class. It accepts a list or tuple of field names you want to show in the form. If you want to show all the fields just use <code>&#34;__all__&#34;</code> (that&#39;s  double underscore).</p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">fields</span> <span class="o">=</span> <span class="s1">&#39;__all__&#39;</span>      <span class="c1"># display all the fields in the form</span>
<span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">]</span>  <span class="c1"># display only title and content field in the form</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Similarly, there exists a complementary attribute called <code>exclude</code> which accepts a list of field names which you don&#39;t want to show in the form.</p>
<div class="codeblock language-python"><div class="highlight"><pre><span></span><span class="n">exclude</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="s1">&#39;pub_date&#39;</span><span class="p">]</span> <span class="c1"># show all the fields except slug and pub_date</span>
</pre></div>
</div>
<p>Let&#39;s update our code to use the <code>fields</code> attribute.</p>

<p><strong>TGDB/django_project/blog/forms.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Author</span><span class="p">,</span> <span class="n">Tag</span><span class="p">,</span> <span class="n">Category</span><span class="p">,</span> <span class="n">Post</span>


<span class="k">class</span> <span class="nc">AuthorForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Author</span>
<span class="hll">        <span class="n">fields</span> <span class="o">=</span> <span class="s1">&#39;__all__&#39;</span>
</span>
    <span class="k">def</span> <span class="nf">clean_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="n">name_l</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name_l</span> <span class="o">==</span> <span class="s2">&#34;admin&#34;</span> <span class="ow">or</span> <span class="n">name_l</span> <span class="o">==</span> <span class="s2">&#34;author&#34;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&#34;Author name can&#39;t be &#39;admin/author&#39;&#34;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name_l</span>

    <span class="k">def</span> <span class="nf">clean_email</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</td></tr></tbody></table></div>
<p>Notice that we haven&#39;t changed <code>clean_name()</code> and <code>clean_email()</code> method because they work with <br/>
<code>ModelForm</code> too.</p>
<span id="additional-validation-in-modelform" class="anchor-target"></span><h2 class="heading">Additional Validation in ModelForm <a class="header-link" href="#additional-validation-in-modelform">#</a></h2>

<p>In addition to Form validation, <code>ModelForm</code> also performs its own validation. What is meant by that? It simply means that ModelForm performs validation at the database level.</p>

<p><code>ModelForm</code> Validation takes place in 3 steps.</p>

<p><code>Model.clean_fields()</code> - This method validates all the fields in the model</p>

<p><code>Model.clean()</code> - Works just like Form&#39;s <code>clean()</code> method. If you want to perform some validation at the database level which requires access to multiple fields override this method in the Model class. By default, this method does nothing.</p>

<p><code>Model.validate_unique()</code> - This method checks uniqueness constraints imposed on your model (using unique parameter).</p>

<p>Which validation occurs first Form validation or Model validation?</p>

<p>Form Validation occurs first.</p>

<p>How do I trigger this Model validation?</p>

<p>Just call <code>is_valid()</code> method as usual and Django will run Form validation followed by <code>ModelForm</code> validation.</p>
<span id="creating-form-classes-for-the-remaning-objects" class="anchor-target"></span><h2 class="heading">Creating Form classes for the remaning objects <a class="header-link" href="#creating-form-classes-for-the-remaning-objects">#</a></h2>

<p>Before we move ahead, let&#39;s create <code>PostForm</code>, <code>CategoryForm</code> and <code>TagForm</code> class in the <code>forms.py</code> file.</p>

<p><strong>TGDB/django_project/blog/forms.py</strong></p>
<div class="codeblock language-python"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#...</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Author</span><span class="p">,</span> <span class="n">Tag</span><span class="p">,</span> <span class="n">Category</span><span class="p">,</span> <span class="n">Post</span>
<span class="hll"><span class="kn">from</span> <span class="nn">django.template.defaultfilters</span> <span class="kn">import</span> <span class="n">slugify</span>
</span>
<span class="c1">#...</span>


<span class="k">class</span> <span class="nc">AuthorForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
    <span class="c1">#...</span>

<span class="hll"><span class="k">class</span> <span class="nc">TagForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span class="hll">        <span class="n">model</span> <span class="o">=</span> <span class="n">Tag</span>
</span><span class="hll">        <span class="n">fields</span> <span class="o">=</span> <span class="s1">&#39;__all__&#39;</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">clean_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span><span class="hll">        <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;tag&#34;</span> <span class="ow">or</span> <span class="n">n</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;add&#34;</span> <span class="ow">or</span> <span class="n">n</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;update&#34;</span><span class="p">:</span>
</span><span class="hll">            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&#34;Tag name can&#39;t be &#39;{}&#39;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">n</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">clean_slug</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;slug&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span class="hll">
</span><span class="hll">
</span><span class="hll"><span class="k">class</span> <span class="nc">CategoryForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span class="hll">        <span class="n">model</span> <span class="o">=</span> <span class="n">Category</span>
</span><span class="hll">        <span class="n">fields</span> <span class="o">=</span> <span class="s1">&#39;__all__&#39;</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">clean_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span><span class="hll">        <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;tag&#34;</span> <span class="ow">or</span> <span class="n">n</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;add&#34;</span> <span class="ow">or</span> <span class="n">n</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;update&#34;</span><span class="p">:</span>
</span><span class="hll">            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&#34;Category name can&#39;t be &#39;{}&#39;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">n</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">clean_slug</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;slug&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span class="hll">
</span><span class="hll">
</span><span class="hll"><span class="k">class</span> <span class="nc">PostForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span class="hll">        <span class="n">model</span> <span class="o">=</span> <span class="n">Post</span>
</span><span class="hll">        <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">,)</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">clean_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
</span><span class="hll">        <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;post&#34;</span> <span class="ow">or</span> <span class="n">n</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;add&#34;</span> <span class="ow">or</span> <span class="n">n</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;update&#34;</span><span class="p">:</span>
</span><span class="hll">            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&#34;Post name can&#39;t be &#39;{}&#39;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">n</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="n">cleaned_data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">PostForm</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span> <span class="c1"># call the parent clean method</span>
</span><span class="hll">        <span class="n">title</span>  <span class="o">=</span> <span class="n">cleaned_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="c1"># if title exists create slug from title</span>
</span><span class="hll">        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
</span><span class="hll">            <span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;slug&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">slugify</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">cleaned_data</span>
</span></pre></div>
</td></tr></tbody></table></div>
<p>The <code>TagForm</code> and <code>CategoryForm</code> are very similar to <code>AuthorForm</code> class but <code>PostForm</code> is a little different. In <code>PostForm</code>, we are overriding Form&#39;s <code>clean()</code> method for the first time. Recall that we commonly use Form&#39;s <code>clean()</code> method when we want to perform some validation which requires access to two or more fields at the same time.</p>

<p>In line 56, we are calling Form&#39;s parent <code>clean()</code> method which by itself does nothing, except returning <code>cleaned_data</code> dictionary.</p>

<p>Next, we are using dictionary object&#39;s <code>get()</code> method to access the <code>title</code> field of the <code>PostForm</code>, recall that in the Form&#39;s <code>clean()</code> method none of the fields is guaranteed to exist.</p>

<p>Then we test the value of the <code>title</code> field. If the <code>title</code> field is not empty, then we use <code>slugify()</code> method to create slug from the <code>title</code> field and assign the result to <code>cleaned_data[&#39;slug&#39;]</code>. At last, we return <code>cleaned_data</code> from the <code>clean()</code> method.</p>

<p>It is important to note that by the time Form&#39;s <code>clean()</code> method is called, <code>clean()</code> methods of the individual field would have already been executed.</p>

<p>That&#39;all for now. This chapter was quite long. Nonetheless, we have learned a lot about Django forms. In the next chapter, we will learn how to render forms in templates.</p>

<p><strong>Note:</strong> To checkout this version of the repository type <code>git checkout 20a</code>.</p>



    



        <nav aria-label="pagination">
            <ul class="pager">
                
                    <li class="previous">
                        <a href="../redirecting-urls-in-django/index.html" title="Redirecting URLs in Django">
                            <span class="fa fa-arrow-left" aria-hidden="true"></span>
                            Redirecting URLs in Django
                        </a>
                    </li>
                

                
                    <li class="next">
                        <a href="../displaying-forms-in-django/index.html" title="Displaying Forms in Django">
                            Displaying Forms in Django
                            <span class="fa fa-arrow-right" aria-hidden="true"></span>
                        </a>
                    </li>
                
            </ul>
        </nav>







    <hr/>
    <div id="disqus_thread">
    <p style="margin-bottom: 10px" class="text-center">
        <a href="#" class=" btn btn-primary comments-holder" onclick="loadDisqus();return false;">
            <i class="fa fa-comments" aria-hidden="true"></i> Load Comments
        </a>
    </p>
    </div>
    <hr/>
    <script>
        var is_disqus_loaded = false;
        function loadDisqus() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = '../../../overiqcom.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        };
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>







            </div>
        </div>


        <div class="sidebar">
        
            <div class="col-lg-4 col-md-4 col-sm-12">
                

    
        
    <div class="well">
        <h4>Django 1.10 Tutorial</h4>
        <ul>
            
                <li><a href="../intro-to-django/index.html">Intro to Django</a></li>
            
                <li><a href="../installing-django/index.html">Installing Django</a></li>
            
                <li><a href="../creating-django-project/index.html">Creating Django Project</a></li>
            
                <li><a href="../mvc-pattern-and-django/index.html">MVC Pattern and Django</a></li>
            
                <li><a href="../views-and-urlconfs-in-django/index.html">Views and URLconfs in Django</a></li>
            
                <li><a href="../basics-of-django-templates/index.html">Basics of Django Templates</a></li>
            
                <li><a href="../template-tags-in-django/index.html">Template tags in Django</a></li>
            
                <li><a href="../template-filters-in-django/index.html">Template filters in Django</a></li>
            
                <li><a href="../loading-templates-in-django/index.html">Loading Templates in Django</a></li>
            
                <li><a href="../template-inheritance-in-django/index.html">Template Inheritance in Django</a></li>
            
                <li><a href="../basics-of-models-in-django/index.html">Basics of Models in Django</a></li>
            
                <li><a href="../migrations-in-django/index.html">Migrations in Django</a></li>
            
                <li><a href="../django-orm-basics/index.html">Django ORM Basics</a></li>
            
                <li><a href="../accessing-related-data-using-django-orm/index.html">Accessing Related Data Using Django ORM</a></li>
            
                <li><a href="../building-blog-the-first-steps/index.html">Building Blog The First Steps</a></li>
            
                <li><a href="../django-admin-app/index.html">Django Admin App</a></li>
            
                <li><a href="../creating-urls-in-django/index.html">Creating URLs in Django</a></li>
            
                <li><a href="../showing-404-errors-in-django/index.html">Showing 404 errors In Django</a></li>
            
                <li><a href="../redirecting-urls-in-django/index.html">Redirecting URLs in Django</a></li>
            
                <li><a href="index.html">Django Form Basics</a></li>
            
                <li><a href="../displaying-forms-in-django/index.html">Displaying Forms in Django</a></li>
            
                <li><a href="../building-contact-us-page/index.html">Building Contact Us Page</a></li>
            
                <li><a href="../django-rendering-fields-manually/index.html">Django Rendering Fields Manually</a></li>
            
                <li><a href="../handling-static-content-in-django/index.html">Handling Static Content in Django</a></li>
            
                <li><a href="../handling-media-files-in-django/index.html">Handling Media Files in Django</a></li>
            
                <li><a href="../pagination-in-django/index.html">Pagination in Django</a></li>
            
                <li><a href="../cookies-in-django/index.html">Cookies in Django</a></li>
            
                <li><a href="../sessions-in-django/index.html">Sessions in Django</a></li>
            
                <li><a href="../django-authentication-framework-basics/index.html">Django Authentication Framework Basics</a></li>
            
                <li><a href="../django-logging-users-in-and-out/index.html">Django Logging Users In and Out</a></li>
            
                <li><a href="../django-password_change-view/index.html">Django password_change() View</a></li>
            
                <li><a href="../django-creating-users-using-usercreationform/index.html">Django Creating Users using UserCreationForm</a></li>
            
                <li><a href="../django-extending-user-model/index.html">Django Extending User model</a></li>
            
                <li><a href="../flatpages-in-django/index.html">Flatpages in Django</a></li>
            
                <li><a href="../creating-sitemaps-in-django/index.html">Creating Sitemaps in Django</a></li>
            
                <li><a href="../revisiting-cadmin-app/index.html">Revisiting cadmin App</a></li>
            
                <li><a href="../integrating-ckeditor-in-django/index.html">Integrating CKeditor in Django</a></li>
            
        </ul>
    </div>

    

    
        

<div class="well">
    <h4>Recent Posts</h4>
    <ul>
        
            <li><a href="../../machine-learning-experts-you-should-be-following-online/index.html">Machine Learning Experts You Should Be Following Online</a></li>
        
            <li><a href="../../4-ways-to-prepare-for-the-ap-computer-science-a-exam/index.html">4 Ways to Prepare for the AP Computer Science A Exam</a></li>
        
            <li><a href="../../finance-assignment-online-help-for-the-busy-and-tired-students-get-help-from-experts/index.html">Finance Assignment Online Help for the Busy and Tired Students: Get Help from Experts</a></li>
        
            <li><a href="../../top-9-machine-learning-algorithms-for-data-scientists/index.html">Top 9 Machine Learning Algorithms for Data Scientists</a></li>
        
            <li><a href="../../data-science-learning-path-or-steps-to-become-a-data-scientist-final/index.html">Data Science Learning Path or Steps to become a data scientist Final</a></li>
        
            <li><a href="../../enable-edit-button-in-shutter-in-linux-mint-19-and-ubuntu-18-04/index.html">Enable Edit Button in Shutter In Linux Mint 19 and Ubuntu 18.04</a></li>
        
            <li><a href="../../python-3-time-module/index.html">Python 3 time module</a></li>
        
            <li><a href="../../pygments-tutorial/index.html">Pygments Tutorial</a></li>
        
            <li><a href="../../how-to-use-virtualenv/index.html">How to use Virtualenv?</a></li>
        
            <li><a href="../../installing-mysql-windows-linux-and-mac/index.html">Installing MySQL (Windows, Linux and Mac)</a></li>
        
            <li><a href="../../what-is-if-__name__-__main__-in-python/index.html">What is if __name__ == &#39;__main__&#39;  in Python ?</a></li>
        
            <li><a href="../../installing-goaccess-a-real-time-web-log-analyzer/index.html">Installing GoAccess (A Real-time web log analyzer)</a></li>
        
            <li><a href="../../installing-isso/index.html">Installing Isso</a></li>
        
    </ul>
</div>

<!-- Blog Search Well -->





















    



            </div>
        </div>
    </div>



    

</div>

<!-- Footer -->
<footer class="overiq-footer">
    <div class="container">
        <div class="row">

            <div class="col-lg-3 col-md-3 col-sm-6 overiq-footer-links">
                <ul>
                    <li><a href="../../index.html">Home</a></li>
                    <li><a href="../../terms-of-use/index.html">Terms</a></li>
                    <li><a href="../../privacy-policy/index.html">Privacy Policy</a></li>
                    <li><a href="../../sitemap.xml/index.html">Sitemap</a></li>
                </ul>

            </div>

            <div class="col-lg-3 col-md-3 col-sm-6 overiq-footer-links">
                <ul>
                    <li><a href="../../contact/index.html">Contact</a></li>
                    <li><a href="../../blog/index.html">Blog</a></li>
                </ul>

            </div>

            <div class="col-lg-3 col-md-3 col-sm-6 overiq-footer-links">
                <ul>
                    <li><a href="https://www.facebook.com/OverIQ/">Facebook</a></li>
                    <li><a href="https://twitter.com/infoOverIQ">Twitter</a></li>
                    <li><a href="https://github.com/overiq">Github</a></li>
                </ul>
            </div>

            <div class="col-lg-3 col-md-3 col-sm-6 overiq-footer-links">
                <ul>
                    <li><a href="../../c-programming-101/index.html">C Tutorial</a></li>
                    <li><a href="../../python-101/index.html">Python Tutorial</a></li>
                    <li><a href="../../django-1-11/index.html">Django Tutorial</a></li>
                    <li><a href="../../flask-101/index.html">Flask Tutorial</a></li>
                    <li><a href="../../mysql-connector-python-101/index.html">MySQL Connector/Python Tutorial</a></li>
                    <li><a href="../../sqlalchemy-101/index.html">SQLAlchemy Tutorial</a></li>
                    <li><a href="../../c-examples/index.html">C Programming Examples</a></li>
                </ul>
            </div>
            <!-- /.col-lg-12 -->
        </div>
        <div class="row text-center">
            <p>© 2025 OverIQ.com</p>
            <small><a href="#">Back to top</a></small>
        </div>

        <!-- /.row -->
    </div>
</footer>



<script type="text/javascript" src="../../static/CACHE/js/output.2e0ff002c1a4.js"></script>




<script async="" src="../../../cdn.jsdelivr.net/npm/cookieconsent%403/build/cookieconsent.min.js" data-cfasync="false"></script>

<script>

    
    window.addEventListener('load', function () {
        window.cookieconsent.initialise({
            "palette": {
                "popup": {
                    "background": "#5ca9e0",
                    "text": "#ffffff"
                },
                "button": {
                    "background": "#fff",
                    "text": "#237afc"
                }
            },
            "theme": "classic",
            "position": "top",
            "static": true,
            "content": {
                "href": "https://overiq.com/privacy-policy/"
            }
        });
    });


</script>

<script src="../../../polyfill.io/v3/polyfill.min1162.js?features=es6"></script>
<script id="MathJax-script" defer="" src="../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml.js"></script>

<script async="" type="text/javascript" src="../../../cdn.carbonads.com/carbonfbdb.js?serve=CE7DC53E&amp;placement=overiqcom" id="_carbonads_js"></script>





<script data-cfasync="false">function _emitEzConsentEvent(){var customEvent=new CustomEvent("ezConsentEvent",{detail:{ezTcfConsent:window.ezTcfConsent},bubbles:true,cancelable:true,});document.dispatchEvent(customEvent);}
(function(window,document){function _setAllEzConsentTrue(){window.ezTcfConsent.loaded=true;window.ezTcfConsent.store_info=true;window.ezTcfConsent.develop_and_improve_services=true;window.ezTcfConsent.measure_ad_performance=true;window.ezTcfConsent.measure_content_performance=true;window.ezTcfConsent.select_basic_ads=true;window.ezTcfConsent.create_ad_profile=true;window.ezTcfConsent.select_personalized_ads=true;window.ezTcfConsent.create_content_profile=true;window.ezTcfConsent.select_personalized_content=true;window.ezTcfConsent.understand_audiences=true;window.ezTcfConsent.use_limited_data_to_select_content=true;window.ezTcfConsent.select_personalized_content=true;}
function _clearEzConsentCookie(){document.cookie="ezCMPCookieConsent=tcf2;Domain=.overiq.com;Path=/;expires=Thu, 01 Jan 1970 00:00:00 GMT";}
_clearEzConsentCookie();if(typeof window.__tcfapi!=="undefined"){window.ezgconsent=false;var amazonHasRun=false;function _ezAllowed(tcdata,purpose){return(tcdata.purpose.consents[purpose]||tcdata.purpose.legitimateInterests[purpose]);}
function _handleConsentDecision(tcdata){window.ezTcfConsent.loaded=true;if(!tcdata.vendor.consents["347"]&&!tcdata.vendor.legitimateInterests["347"]){window._emitEzConsentEvent();return;}
window.ezTcfConsent.store_info=_ezAllowed(tcdata,"1");window.ezTcfConsent.develop_and_improve_services=_ezAllowed(tcdata,"10");window.ezTcfConsent.measure_content_performance=_ezAllowed(tcdata,"8");window.ezTcfConsent.select_basic_ads=_ezAllowed(tcdata,"2");window.ezTcfConsent.create_ad_profile=_ezAllowed(tcdata,"3");window.ezTcfConsent.select_personalized_ads=_ezAllowed(tcdata,"4");window.ezTcfConsent.create_content_profile=_ezAllowed(tcdata,"5");window.ezTcfConsent.measure_ad_performance=_ezAllowed(tcdata,"7");window.ezTcfConsent.use_limited_data_to_select_content=_ezAllowed(tcdata,"11");window.ezTcfConsent.select_personalized_content=_ezAllowed(tcdata,"6");window.ezTcfConsent.understand_audiences=_ezAllowed(tcdata,"9");window._emitEzConsentEvent();}
function _handleGoogleConsentV2(tcdata){if(!tcdata||!tcdata.purpose||!tcdata.purpose.consents){return;}
var googConsentV2={};if(tcdata.purpose.consents[1]){googConsentV2.ad_storage='granted';googConsentV2.analytics_storage='granted';}
if(tcdata.purpose.consents[3]&&tcdata.purpose.consents[4]){googConsentV2.ad_personalization='granted';}
if(tcdata.purpose.consents[1]&&tcdata.purpose.consents[7]){googConsentV2.ad_user_data='granted';}
if(googConsentV2.analytics_storage=='denied'){gtag('set','url_passthrough',true);}
gtag('consent','update',googConsentV2);}
__tcfapi("addEventListener",2,function(tcdata,success){if(!success||!tcdata){window._emitEzConsentEvent();return;}
if(!tcdata.gdprApplies){_setAllEzConsentTrue();window._emitEzConsentEvent();return;}
if(tcdata.eventStatus==="useractioncomplete"||tcdata.eventStatus==="tcloaded"){if(typeof gtag!='undefined'){_handleGoogleConsentV2(tcdata);}
_handleConsentDecision(tcdata);if(tcdata.purpose.consents["1"]===true&&tcdata.vendor.consents["755"]!==false){window.ezgconsent=true;(adsbygoogle=window.adsbygoogle||[]).pauseAdRequests=0;}
if(window.__ezconsent){__ezconsent.setEzoicConsentSettings(ezConsentCategories);}
__tcfapi("removeEventListener",2,function(success){return null;},tcdata.listenerId);if(!(tcdata.purpose.consents["1"]===true&&_ezAllowed(tcdata,"2")&&_ezAllowed(tcdata,"3")&&_ezAllowed(tcdata,"4"))){if(typeof __ez=="object"&&typeof __ez.bit=="object"&&typeof window["_ezaq"]=="object"&&typeof window["_ezaq"]["page_view_id"]=="string"){__ez.bit.Add(window["_ezaq"]["page_view_id"],[new __ezDotData("non_personalized_ads",true),]);}}}});}else{_setAllEzConsentTrue();window._emitEzConsentEvent();}})(window,document);</script></body>
<!-- Mirrored from overiq.com/django-1-10/django-form-basics/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 01 Feb 2025 11:04:06 GMT -->
</html>